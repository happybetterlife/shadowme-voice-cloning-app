(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[974],{9185:(e,t,a)=>{Promise.resolve().then(a.bind(a,1568))},1568:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>eS});var s=a(5155),r=a(2115);function l(e){let{children:t,onClick:a,disabled:r=!1,size:l="md",variant:i="primary",className:n="",type:c="button",style:o}=e;return(0,s.jsx)("button",{type:c,onClick:a,disabled:r,className:"\n        inline-flex items-center justify-center rounded-xl font-medium\n        transition-all duration-200 ease-in-out\n        disabled:opacity-50 disabled:cursor-not-allowed\n        focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2\n        relative z-50\n        ".concat((()=>{switch(l){case"sm":return"px-4 py-2 text-sm min-h-[40px]";case"lg":return"px-8 py-4 text-lg min-h-[56px]";default:return"px-6 py-3 text-base min-h-[48px]"}})(),"\n        ").concat("primary"===i?"bg-gradient-to-r from-app-gradient-from to-app-gradient-to hover:from-app-gradient-from-dark hover:to-app-gradient-to-dark text-white shadow-lg hover:shadow-xl":"bg-gradient-to-r from-gray-100 to-gray-200 hover:from-gray-200 hover:to-gray-300 text-gray-800 border border-gray-300 dark:from-gray-700 dark:to-gray-800 dark:hover:from-gray-600 dark:hover:to-gray-700 dark:text-gray-100 dark:border-gray-600","\n        ").concat(n,"\n      "),style:{position:"relative",zIndex:9999,isolation:"isolate",...o},children:t})}function i(e){let{isActive:t=!1,size:a="md",className:r=""}=e,l={sm:"h-4",md:"h-8",lg:"h-12"};return(0,s.jsx)("div",{className:"flex items-center justify-center gap-1 ".concat(r),children:Array.from({length:"sm"===a?5:"md"===a?8:12}).map((e,r)=>(0,s.jsx)("div",{className:"w-1 bg-gradient-to-t from-app-gradient-from to-app-gradient-to rounded-full transition-all duration-300 ".concat(l[a]," ").concat(t?"waveform-bar opacity-100":"opacity-30 scale-y-50"),style:{animationDelay:t?"".concat(.1*r,"s"):"0s"}},r))})}var n=a(6164),c=a(8207),o=a(5220),d=a(7072);function x(e){let{onGetStarted:t,onLogin:a}=e;return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-cyan-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:(0,s.jsxs)("div",{className:"w-full px-4 py-8 flex flex-col justify-center min-h-screen",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsxs)("div",{className:"relative mb-6",children:[(0,s.jsx)("div",{className:"w-20 h-20 mx-auto bg-gradient-to-r from-blue-600 to-cyan-600 rounded-2xl flex items-center justify-center mb-4 shadow-xl",children:(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(n.A,{className:"w-8 h-8 text-white"}),(0,s.jsx)("div",{className:"absolute -top-1 -right-1 w-5 h-5 bg-gradient-to-r from-green-400 to-cyan-400 rounded-full flex items-center justify-center",children:(0,s.jsx)(c.A,{className:"w-2.5 h-2.5 text-white"})})]})}),(0,s.jsx)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent mb-2",children:"ShadowME"}),(0,s.jsx)("p",{className:"text-lg text-gray-600 dark:text-gray-300 px-2",children:"AI로 복제된 내 목소리로 원어민 발음 마스터하기"})]}),(0,s.jsx)("div",{className:"mb-6",children:(0,s.jsx)(i,{isActive:!0,className:"opacity-60"})})]}),(0,s.jsxs)("div",{className:"space-y-4 mb-8",children:[(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-lg border border-gray-100 dark:border-gray-700",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,s.jsx)(o.A,{className:"w-5 h-5 text-white"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"font-semibold mb-1 text-gray-800 dark:text-gray-200",children:"음성 복제 기술"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"AI가 내 목소리를 학습하여 원어민 발음으로 변환"})]})]})}),(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-lg border border-gray-100 dark:border-gray-700",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-green-500 to-cyan-500 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,s.jsx)(c.A,{className:"w-5 h-5 text-white"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"font-semibold mb-1 text-gray-800 dark:text-gray-200",children:"맞춤형 학습"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"개인의 수준과 목적에 맞는 맞춤형 연습 문장 제공"})]})]})}),(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-lg border border-gray-100 dark:border-gray-700",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,s.jsx)(d.A,{className:"w-5 h-5 text-white"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"font-semibold mb-1 text-gray-800 dark:text-gray-200",children:"실시간 피드백"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"단어별 정확도를 실시간으로 분석하여 즉각적인 피드백"})]})]})})]}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(l,{size:"lg",onClick:t,className:"w-full min-h-[56px]",children:"시작하기"}),(0,s.jsx)(l,{size:"lg",variant:"secondary",onClick:a,className:"w-full min-h-[56px]",children:"로그인"})]}),(0,s.jsx)("div",{className:"mt-8 text-center",children:(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 px-4",children:"개인정보는 사용자 기기에만 저장되며 외부로 전송되지 않습니다"})})]})})}var m=a(3463),g=a(9795);function u(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return(0,g.QP)((0,m.$)(t))}function h(e){let{className:t,type:a,...r}=e;return(0,s.jsx)("input",{type:a,"data-slot":"input",className:u("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border px-3 py-1 text-base bg-input-background transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",t),...r})}var p=a(7364),y=a(1466),b=a(6462),f=a(8686),v=a(6232);let j="zxyvqsevekrhwzjulyaq",w="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inp4eXZxc2V2ZWtyaHd6anVseWFxIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTI2NTMzNDgsImV4cCI6MjA2ODIyOTM0OH0.1uG9-dGGkuiFFWz0zxtjN54dPjMxbSWjii0n9SC-KgY",N=(0,v.UU)("https://".concat(j,".supabase.co"),w);class k{setAccessToken(e){this.accessToken=e,e&&N.auth.setSession({access_token:e,refresh_token:e})}async saveUserProfile(e){try{let{data:t}=await N.auth.getUser();if(!t.user)throw Error("User not authenticated");let{data:a,error:s}=await N.from("user_profiles").upsert({id:t.user.id,email:e.email,name:e.name,level:e.level||"beginner",purpose:e.purpose||"conversation",updated_at:new Date().toISOString()}).select().single();if(s)throw s;return{profile:a}}catch(e){throw console.error("Failed to save user profile:",e),e}}async getUserProfile(){try{let{data:e}=await N.auth.getUser();if(!e.user)throw Error("User not authenticated");let{data:t,error:a}=await N.from("user_profiles").select("*").eq("id",e.user.id).single();if(a)throw a;return{profile:t}}catch(e){throw console.error("Failed to get user profile:",e),e}}async saveSession(e){try{let{data:t}=await N.auth.getUser();if(!t.user)throw Error("User not authenticated");let{data:a,error:s}=await N.from("user_sessions").insert({user_id:t.user.id,...e,completed_at:new Date().toISOString()}).select().single();if(s)throw s;let{error:r}=await N.from("user_profiles").update({total_sessions:1,total_practice_time:e.practice_time||0,average_accuracy:e.overall_accuracy,last_practice:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",t.user.id);return r&&console.warn("Profile update failed:",r),await this.updateDailyProgress({practiceTime:e.practice_time||0,lessonsCompleted:1,accuracyScore:e.overall_accuracy||0}),{session_id:a.id,message:"Session saved successfully"}}catch(e){throw console.error("Failed to save session:",e),e}}async updateDailyProgress(e){try{let{data:t}=await N.auth.getUser();if(!t.user)throw Error("User not authenticated");let a=new Date().toISOString().split("T")[0],{data:s,error:r}=await N.from("daily_progress").select("*").eq("user_id",t.user.id).eq("date",a).maybeSingle();if(r)throw r;if(s){let t=[...s.accuracy_scores||[],e.accuracyScore],a=t.reduce((e,t)=>e+t,0)/t.length,{error:r}=await N.from("daily_progress").update({practice_time:s.practice_time+e.practiceTime,lessons_completed:s.lessons_completed+e.lessonsCompleted,total_sessions:s.total_sessions+1,accuracy_scores:t,average_accuracy:Math.round(100*a)/100,daily_goal_achieved:s.practice_time+e.practiceTime>=900,updated_at:new Date().toISOString()}).eq("id",s.id);if(r)throw r}else{let{error:s}=await N.from("daily_progress").insert({user_id:t.user.id,date:a,practice_time:e.practiceTime,lessons_completed:e.lessonsCompleted,total_sessions:1,accuracy_scores:[e.accuracyScore],average_accuracy:e.accuracyScore,daily_goal_achieved:e.practiceTime>=900});if(s)throw s}return{message:"Daily progress updated successfully"}}catch(e){throw console.error("Failed to update daily progress:",e),e}}async getDailyProgress(e){try{let{data:t}=await N.auth.getUser();if(!t.user)throw Error("User not authenticated");let a=e||new Date().toISOString().split("T")[0],{data:s,error:r}=await N.from("daily_progress").select("*").eq("user_id",t.user.id).eq("date",a).maybeSingle();if(r)throw r;return s||{date:a,practice_time:0,lessons_completed:0,total_sessions:0,accuracy_scores:[],average_accuracy:0,daily_goal_achieved:!1}}catch(t){return console.error("Failed to get daily progress:",t),{date:e||new Date().toISOString().split("T")[0],practice_time:0,lessons_completed:0,total_sessions:0,accuracy_scores:[],average_accuracy:0,daily_goal_achieved:!1}}}async getWeeklyProgress(){try{let{data:e}=await N.auth.getUser();if(!e.user)throw Error("User not authenticated");let t=new Date,a=new Date(t);a.setDate(t.getDate()-6);let{data:s,error:r}=await N.from("daily_progress").select("*").eq("user_id",e.user.id).gte("date",a.toISOString().split("T")[0]).lte("date",t.toISOString().split("T")[0]).order("date",{ascending:!0});if(r)throw r;let l=[];for(let e=6;e>=0;e--){let a=new Date(t);a.setDate(t.getDate()-e);let r=a.toISOString().split("T")[0],i=(null==s?void 0:s.find(e=>e.date===r))||{date:r,practice_time:0,lessons_completed:0,total_sessions:0,accuracy_scores:[],average_accuracy:0,daily_goal_achieved:!1};l.push(i)}return l}catch(e){return console.error("Failed to get weekly progress:",e),[]}}constructor(){this.accessToken=null}}let S=new k;class _{setAccessToken(e){this.accessToken=e}getHeaders(){return{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.accessToken||"")}}async getDailyProgress(e){let t=new URLSearchParams({type:"daily"});e&&t.append("date",e);let a=await fetch("".concat(this.baseUrl,"/learning-progress?").concat(t),{headers:this.getHeaders()});if(!a.ok)throw Error("Failed to get daily progress");return(await a.json()).progress}async getWeeklyProgress(){let e=await fetch("".concat(this.baseUrl,"/learning-progress?type=weekly"),{headers:this.getHeaders()});if(!e.ok)throw Error("Failed to get weekly progress");return(await e.json()).progress}async getMonthlyStats(){let e=await fetch("".concat(this.baseUrl,"/learning-progress?type=monthly"),{headers:this.getHeaders()});if(!e.ok)throw Error("Failed to get monthly stats");return(await e.json()).stats}async getLearningSummary(){let e=await fetch("".concat(this.baseUrl,"/learning-progress?type=summary"),{headers:this.getHeaders()});if(!e.ok)throw Error("Failed to get learning summary");return(await e.json()).summary}async updateProgress(e){let t=await fetch("".concat(this.baseUrl,"/learning-progress"),{method:"POST",headers:this.getHeaders(),body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to update progress");return(await t.json()).progress}async createSession(e){let t=await fetch("".concat(this.baseUrl,"/learning-progress"),{method:"PUT",headers:this.getHeaders(),body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to create session");return await t.json()}async getVoiceClones(){let e=await fetch("".concat(this.baseUrl,"/voice-clones"),{headers:this.getHeaders()});if(!e.ok)throw Error("Failed to get voice clones");return(await e.json()).voices}async saveVoiceClone(e){let t=await fetch("".concat(this.baseUrl,"/voice-clones"),{method:"POST",headers:this.getHeaders(),body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to save voice clone");return(await t.json()).voice_clone}async deleteVoiceClone(e){let t=await fetch("".concat(this.baseUrl,"/voice-clones?voiceId=").concat(e),{method:"DELETE",headers:this.getHeaders()});if(!t.ok)throw Error("Failed to delete voice clone");return await t.json()}async getPracticeRecords(e){let t=new URLSearchParams;(null==e?void 0:e.sessionId)&&t.append("sessionId",e.sessionId),(null==e?void 0:e.sentenceId)&&t.append("sentenceId",e.sentenceId),(null==e?void 0:e.limit)&&t.append("limit",e.limit.toString()),(null==e?void 0:e.offset)&&t.append("offset",e.offset.toString()),(null==e?void 0:e.startDate)&&t.append("startDate",e.startDate),(null==e?void 0:e.endDate)&&t.append("endDate",e.endDate);let a=await fetch("".concat(this.baseUrl,"/practice-records?").concat(t),{headers:this.getHeaders()});if(!a.ok)throw Error("Failed to get practice records");return await a.json()}async createPracticeRecord(e){let t=await fetch("".concat(this.baseUrl,"/practice-records"),{method:"POST",headers:this.getHeaders(),body:JSON.stringify(e)});if(!t.ok)throw Error("Failed to create practice record");return(await t.json()).record}async updatePracticeRecord(e,t){let a=await fetch("".concat(this.baseUrl,"/practice-records?recordId=").concat(e),{method:"PUT",headers:this.getHeaders(),body:JSON.stringify(t)});if(!a.ok)throw Error("Failed to update practice record");return(await a.json()).record}async getTodayStats(){let e=new Date().toISOString().split("T")[0],[t,a]=await Promise.all([this.getDailyProgress(e),this.getPracticeRecords({startDate:e,endDate:e})]);return{progress:t,practiceRecords:a.records,sentenceStats:a.stats}}async getWeeklyStats(){let e=new Date,t=new Date;t.setDate(t.getDate()-7);let[a,s]=await Promise.all([this.getWeeklyProgress(),this.getPracticeRecords({startDate:t.toISOString().split("T")[0],endDate:e.toISOString().split("T")[0]})]);return{weeklyProgress:a,practiceRecords:s.records,sentenceStats:s.stats}}constructor(e){this.accessToken=null,this.baseUrl=e||"/api"}}let A=new _,I="https://".concat(j,".supabase.co/functions/v1/make-server-2238568e");class T{setAccessToken(e){this.accessToken=e,S.setAccessToken(e),A.setAccessToken(e)}setUserId(e){this.userId=e}getHeaders(){return{"Content-Type":"application/json",Authorization:"Bearer ".concat(this.accessToken||w)}}async signup(e,t,a){let s=await fetch("".concat(I,"/auth/signup"),{method:"POST",headers:this.getHeaders(),body:JSON.stringify({email:e,password:t,name:a})});if(!s.ok)throw Error((await s.json()).error||"Signup failed");return s.json()}async getProfile(){try{return await S.getUserProfile()}catch(e){if(console.warn("Supabase profile fetch failed, falling back to localStorage:",e),this.userId){let e=localStorage.getItem("user_profile_".concat(this.userId));if(e)return{profile:JSON.parse(e)}}throw Error("Profile not found")}}async saveSession(e){try{return await S.saveSession({session_type:e.type||"practice",level:e.level||"beginner",purpose:e.purpose,practice_time:e.practice_time||0,overall_accuracy:e.overall_accuracy||0,sentences_completed:e.sentences_completed,total_sentences:e.total_sentences,sentence_results:e.sentence_results,voice_analysis:e.voice_analysis})}catch(l){if(console.warn("Supabase session save failed, falling back to localStorage:",l),!this.userId)return{error:"User not logged in"};let t="session_".concat(this.userId,"_").concat(Date.now()),a={id:t,user_id:this.userId,...e,completed_at:new Date().toISOString()};localStorage.setItem(t,JSON.stringify(a));let s="user_profile_".concat(this.userId),r=localStorage.getItem(s);if(r){let t=JSON.parse(r),a={...t,total_sessions:(t.total_sessions||0)+1,total_practice_time:(t.total_practice_time||0)+(e.practice_time||0),average_accuracy:e.overall_accuracy||t.average_accuracy,last_practice:new Date().toISOString(),streak_count:this.calculateStreak(t.last_practice)};localStorage.setItem(s,JSON.stringify(a))}return{message:"Session saved successfully",session_id:t}}}calculateStreak(e){if(!e)return 1;let t=new Date,a=new Date(e),s=Math.ceil(Math.abs(t.getTime()-a.getTime())/864e5);return 1===s?this.getCurrentStreak()+1:s>1?1:this.getCurrentStreak()}getCurrentStreak(){if(!this.userId)return 0;let e="user_profile_".concat(this.userId),t=localStorage.getItem(e);return t&&JSON.parse(t).streak_count||0}async updateDailyProgress(e){if(!this.userId)return null;let t=new Date().toISOString().split("T")[0],a="daily_progress_".concat(this.userId,"_").concat(t),s=localStorage.getItem(a),r=s?JSON.parse(s):{date:t,practiceTime:0,lessonsCompleted:0,accuracyScores:[],totalSessions:0},l={...r,practiceTime:r.practiceTime+e.practiceTime,lessonsCompleted:r.lessonsCompleted+e.lessonsCompleted,accuracyScores:[...r.accuracyScores,e.accuracyScore],totalSessions:r.totalSessions+1,lastUpdated:new Date().toISOString()};return localStorage.setItem(a,JSON.stringify(l)),l}async getDailyProgress(e){try{return await S.getDailyProgress(e)}catch(r){if(console.warn("Supabase daily progress fetch failed, falling back to localStorage:",r),!this.userId)return null;let t=e||new Date().toISOString().split("T")[0],a="daily_progress_".concat(this.userId,"_").concat(t),s=localStorage.getItem(a);return s?JSON.parse(s):{date:t,practiceTime:0,lessonsCompleted:0,accuracyScores:[],totalSessions:0}}}async getWeeklyProgress(){try{return await S.getWeeklyProgress()}catch(a){console.warn("Supabase weekly progress fetch failed, falling back to localStorage:",a);let e=[],t=new Date;for(let a=6;a>=0;a--){let s=new Date(t);s.setDate(t.getDate()-a);let r=s.toISOString().split("T")[0],l=await this.getDailyProgress(r);e.push(l)}return e}}constructor(){this.accessToken=null,this.userId=null}}let C=new T;function D(e){let{onBack:t,onAuthSuccess:a,mode:i}=e,[n,c]=(0,r.useState)("login"===i),[o,d]=(0,r.useState)(!1),[x,m]=(0,r.useState)({email:"",password:"",name:""}),g=(0,v.UU)("https://".concat(j,".supabase.co"),w),u=async e=>{e.preventDefault(),d(!0);try{if(n){let{data:e,error:t}=await g.auth.signInWithPassword({email:x.email,password:x.password});if(t)throw t;C.setAccessToken(e.session.access_token),C.setUserId(e.user.id),a(e.user,e.session.access_token)}else{let{data:e,error:t}=await g.auth.signUp({email:x.email,password:x.password,options:{data:{name:x.name,level:"beginner",purpose:"conversation"}}});if(t)throw t;if(e.user){let t={id:e.user.id,email:x.email,name:x.name,level:"beginner",purpose:"conversation",created_at:new Date().toISOString(),streak_count:0,total_practice_time:0,total_sessions:0,average_accuracy:0};localStorage.setItem("user_profile_".concat(e.user.id),JSON.stringify(t));let{data:s,error:r}=await g.auth.signInWithPassword({email:x.email,password:x.password});if(r)throw r;C.setAccessToken(s.session.access_token),C.setUserId(s.user.id),a(s.user,s.session.access_token)}}}catch(e){console.error("Auth error:",e),alert(e.message||"Authentication failed")}finally{d(!1)}};return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-cyan-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex flex-col text-white",children:(0,s.jsxs)("div",{className:"w-full px-4 py-6",children:[(0,s.jsx)("button",{onClick:t,className:"p-2 rounded-lg hover:bg-white/10 transition-colors mb-6 min-h-[44px] min-w-[44px] flex items-center justify-center",children:(0,s.jsx)(p.A,{className:"w-5 h-5 text-white"})}),(0,s.jsx)("div",{className:"w-full max-w-sm mx-auto",children:(0,s.jsxs)("div",{className:"bg-white/80 backdrop-blur-md rounded-xl p-8 shadow-xl border border-gray-200",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("h1",{className:"text-2xl font-bold mb-2 bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent",children:n?"로그인":"회원가입"}),(0,s.jsx)("p",{className:"text-gray-700 text-sm",children:n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent font-semibold",children:"ShadowME"}),(0,s.jsx)("span",{className:"text-gray-700",children:"에 로그인하세요"})]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent font-semibold",children:"ShadowME"}),(0,s.jsx)("span",{className:"text-gray-700",children:" 계정을 만들어보세요"})]})})]}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("form",{onSubmit:u,className:"space-y-4",children:[!n&&(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(y.A,{className:"absolute left-3 top-3.5 w-4 h-4 text-gray-400"}),(0,s.jsx)(h,{type:"text",placeholder:"이름",value:x.name,onChange:e=>m({...x,name:e.target.value}),className:"pl-10 min-h-[48px] bg-white border-gray-300 text-gray-700 placeholder:text-gray-400",required:!0})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(b.A,{className:"absolute left-3 top-3.5 w-4 h-4 text-gray-400"}),(0,s.jsx)(h,{type:"email",placeholder:"이메일",value:x.email,onChange:e=>m({...x,email:e.target.value}),className:"pl-10 min-h-[48px] bg-white border-gray-300 text-gray-700 placeholder:text-gray-400",required:!0})]}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(f.A,{className:"absolute left-3 top-3.5 w-4 h-4 text-gray-400"}),(0,s.jsx)(h,{type:"password",placeholder:"비밀번호",value:x.password,onChange:e=>m({...x,password:e.target.value}),className:"pl-10 min-h-[48px] bg-white border-gray-300 text-gray-700 placeholder:text-gray-400",required:!0})]}),(0,s.jsx)(l,{type:"submit",disabled:o,className:"w-full min-h-[56px] bg-white text-blue-600 hover:bg-white/90",size:"lg",children:o?"처리 중...":n?"로그인":"회원가입"})]}),(0,s.jsx)("div",{className:"mt-6 text-center",children:(0,s.jsx)("button",{onClick:()=>c(!n),className:"text-blue-600 hover:text-blue-700 text-sm min-h-[44px] px-4 flex items-center justify-center mx-auto transition-colors",children:n?"계정이 없으신가요? 회원가입":"이미 계정이 있으신가요? 로그인"})})]})]})})]})})}function U(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card",className:u("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border",t),...a})}function P(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-header",className:u("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 pt-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function F(e){let{className:t,...a}=e;return(0,s.jsx)("h4",{"data-slot":"card-title",className:u("leading-none",t),...a})}function O(e){let{className:t,...a}=e;return(0,s.jsx)("div",{"data-slot":"card-content",className:u("px-6 [&:last-child]:pb-6",t),...a})}let R=e=>e>=90?"text-green-700 bg-green-100 border-green-200 dark:bg-green-900/30 dark:border-green-700":e>=80?"text-lime-700 bg-lime-100 border-lime-200 dark:bg-lime-900/30 dark:border-lime-700":e>=70?"text-yellow-700 bg-yellow-100 border-yellow-200 dark:bg-yellow-900/30 dark:border-yellow-700":e>=60?"text-orange-700 bg-orange-100 border-orange-200 dark:bg-orange-900/30 dark:border-orange-700":"text-red-700 bg-red-100 border-red-200 dark:bg-red-900/30 dark:border-red-700",E=()=>[{range:"90-100%",color:"bg-green-500",label:"완벽",description:"완벽한 발음"},{range:"80-89%",color:"bg-lime-500",label:"우수",description:"우수한 발음"},{range:"70-79%",color:"bg-yellow-500",label:"양호",description:"양호한 발음"},{range:"60-69%",color:"bg-orange-500",label:"보통",description:"개선 필요"},{range:"60% 미만",color:"bg-red-500",label:"미흡",description:"연습 필요"}];function z(e){let{accuracy:t,size:a="md",showText:r=!0,className:l=""}=e;return(0,s.jsxs)("div",{className:"\n      inline-flex items-center gap-1 rounded-full border font-medium\n      ".concat(R(t),"\n      ").concat((()=>{switch(a){case"sm":return"px-2 py-1 text-xs";case"lg":return"px-4 py-2 text-base";default:return"px-3 py-1.5 text-sm"}})(),"\n      ").concat(l,"\n    "),children:[(0,s.jsx)("div",{className:"w-2 h-2 rounded-full bg-current"}),r&&(0,s.jsxs)("span",{children:[t,"%"]})]})}var L=a(9177);function M(e){let{className:t,value:a,...r}=e;return(0,s.jsx)(L.bL,{"data-slot":"progress",className:u("bg-primary/20 relative h-2 w-full overflow-hidden rounded-full",t),...r,children:(0,s.jsx)(L.C1,{"data-slot":"progress-indicator",className:"bg-primary h-full w-full flex-1 transition-all",style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})}var V=a(8236),J=a(2423),W=a(9676),B=a(7819),q=a(6878),H=a(9191);function G(e){let{onStartPractice:t,onSettings:a,userProfile:i,clonedVoiceData:n}=e,[c,o]=(0,r.useState)(null),[d,x]=(0,r.useState)([]),[m,g]=(0,r.useState)(!0);(0,r.useEffect)(()=>{u()},[]);let u=async()=>{try{let[e,t]=await Promise.all([C.getDailyProgress(),C.getWeeklyProgress()]);o(e),x(t)}catch(e){console.error("Failed to load progress data:",e)}finally{g(!1)}},h=async e=>{if("shadowing"===e){t();try{await C.updateDailyProgress({practiceTime:0,lessonsCompleted:0,accuracyScore:0}),console.log("✅ Practice session started")}catch(e){console.error("❌ Failed to record practice start:",e)}}else console.log("Starting ".concat(e," practice..."))},p={practiceTime:15,lessonsCompleted:3},y=c?Math.min((c.practiceTime/p.practiceTime+c.lessonsCompleted/p.lessonsCompleted)/2*100,100):0,b=d.filter(e=>e.lessonsCompleted>0).length,f={streak:(null==i?void 0:i.streak_count)||0,accuracy:(null==i?void 0:i.average_accuracy)||0,practiceTime:(null==i?void 0:i.total_practice_time)||0,level:(null==i?void 0:i.level)||"초급",todayProgress:Math.round(y),weeklyGoal:Math.round(b/7*100)},v=[{id:1,title:"쉐도잉 연습",difficulty:f.level,duration:"15분",completed:!1,type:"shadowing"},{id:2,title:"발음 교정",difficulty:f.level,duration:"10분",completed:(null==c?void 0:c.lessonsCompleted)>0,type:"pronunciation"},{id:3,title:"유창성 훈련",difficulty:f.level,duration:"20분",completed:(null==c?void 0:c.lessonsCompleted)>1,type:"fluency"}];return m?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-cyan-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"로딩 중..."})]})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-cyan-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:[(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 shadow-sm border-b border-gray-200 dark:border-gray-700",children:(0,s.jsx)("div",{className:"w-full px-4 py-4",children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h1",{className:"text-xl text-gray-800 dark:text-gray-200",children:"안녕하세요! \uD83D\uDC4B"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"오늘도 발음 연습을 시작해보세요"})]}),(0,s.jsx)("button",{onClick:a,className:"p-2 rounded-lg hover:bg-gray-100 dark:hover:bg-gray-700 transition-colors min-h-[44px] min-w-[44px] flex items-center justify-center",children:(0,s.jsx)(V.A,{className:"w-5 h-5 text-gray-600 dark:text-gray-400"})})]})})}),(0,s.jsxs)("div",{className:"w-full px-4 py-6",children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-3 mb-6",children:[(0,s.jsx)(U,{className:"bg-gradient-to-r from-blue-50 to-cyan-50 dark:from-blue-900/20 dark:to-cyan-900/20 border-blue-200 dark:border-blue-800",children:(0,s.jsx)(O,{className:"p-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-lg flex items-center justify-center",children:(0,s.jsx)(J.A,{className:"w-4 h-4 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"연속 학습"}),(0,s.jsxs)("p",{className:"text-lg font-bold text-gray-800 dark:text-gray-200",children:[f.streak,"일"]})]})]})})}),(0,s.jsx)(U,{className:"bg-gradient-to-r from-green-50 to-emerald-50 dark:from-green-900/20 dark:to-emerald-900/20 border-green-200 dark:border-green-800",children:(0,s.jsx)(O,{className:"p-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-green-500 to-emerald-500 rounded-lg flex items-center justify-center",children:(0,s.jsx)(W.A,{className:"w-4 h-4 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"평균 정확도"}),(0,s.jsxs)("p",{className:"text-lg font-bold text-gray-800 dark:text-gray-200",children:[f.accuracy,"%"]})]})]})})}),(0,s.jsx)(U,{className:"bg-gradient-to-r from-purple-50 to-pink-50 dark:from-purple-900/20 dark:to-pink-900/20 border-purple-200 dark:border-purple-800",children:(0,s.jsx)(O,{className:"p-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-500 rounded-lg flex items-center justify-center",children:(0,s.jsx)(B.A,{className:"w-4 h-4 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"레벨"}),(0,s.jsx)("p",{className:"text-lg font-bold text-gray-800 dark:text-gray-200",children:f.level})]})]})})}),(0,s.jsx)(U,{className:"bg-gradient-to-r from-orange-50 to-red-50 dark:from-orange-900/20 dark:to-red-900/20 border-orange-200 dark:border-orange-800",children:(0,s.jsx)(O,{className:"p-3",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("div",{className:"w-8 h-8 bg-gradient-to-r from-orange-500 to-red-500 rounded-lg flex items-center justify-center",children:(0,s.jsx)(q.A,{className:"w-4 h-4 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-xs text-gray-600 dark:text-gray-400",children:"총 연습시간"}),(0,s.jsxs)("p",{className:"text-lg font-bold text-gray-800 dark:text-gray-200",children:[f.practiceTime,"분"]})]})]})})})]}),(0,s.jsxs)(U,{className:"mb-6",children:[(0,s.jsx)(P,{className:"pb-3",children:(0,s.jsx)(F,{className:"text-base",children:"오늘의 진행상황"})}),(0,s.jsx)(O,{className:"pt-0",children:(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("span",{className:"text-sm text-gray-600 dark:text-gray-400",children:["일일 목표 (",f.weeklyGoal,"회 연습)"]}),(0,s.jsx)(z,{accuracy:f.todayProgress,showText:!1,size:"sm"})]}),(0,s.jsx)(M,{value:f.todayProgress,className:"h-2"}),(0,s.jsxs)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:[f.todayProgress,"% 완료 (목표까지 ",100-f.todayProgress,"% 남음)"]})]})})]}),(0,s.jsxs)(U,{className:"mb-6",children:[(0,s.jsx)(P,{className:"pb-3",children:(0,s.jsx)(F,{className:"text-base",children:"오늘의 레슨"})}),(0,s.jsx)(O,{className:"pt-0",children:(0,s.jsx)("div",{className:"space-y-3",children:v.map(e=>(0,s.jsx)("div",{className:"p-3 rounded-lg border transition-all ".concat(e.completed?"bg-green-50 border-green-200 dark:bg-green-900/20 dark:border-green-800":"bg-white border-gray-200 hover:border-blue-300 dark:bg-gray-800 dark:border-gray-700 dark:hover:border-blue-600"),children:(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-800 dark:text-gray-200",children:e.title}),(0,s.jsxs)("div",{className:"flex items-center gap-2 mt-1",children:[(0,s.jsx)("span",{className:"text-xs px-2 py-1 rounded-full bg-gray-100 text-gray-600 dark:bg-gray-700 dark:text-gray-300",children:e.difficulty}),(0,s.jsx)("span",{className:"text-xs text-gray-500 dark:text-gray-400",children:e.duration})]})]}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[e.completed&&(0,s.jsx)("div",{className:"w-5 h-5 bg-green-500 rounded-full flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-white text-xs",children:"✓"})}),!e.completed&&(0,s.jsx)("button",{onClick:()=>h(e.type),className:"p-2 rounded-lg hover:bg-blue-100 dark:hover:bg-blue-900/50 transition-colors min-h-[36px] min-w-[36px] flex items-center justify-center",children:(0,s.jsx)(H.A,{className:"w-3 h-3 text-blue-600 dark:text-blue-400"})})]})]})},e.id))})})]}),(0,s.jsx)("div",{className:"space-y-3",children:(0,s.jsxs)(l,{size:"lg",onClick:()=>h("shadowing"),className:"w-full min-h-[56px]",children:[(0,s.jsx)(H.A,{className:"w-5 h-5 mr-2"}),"쉐도잉 연습 시작"]})})]})]})}var X=a(1290),Z=a(1027);let Y=(0,Z.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-white hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background text-foreground hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9 rounded-md"}},defaultVariants:{variant:"default",size:"default"}});function K(e){let{className:t,variant:a,size:r,asChild:l=!1,...i}=e,n=l?X.DX:"button";return(0,s.jsx)(n,{"data-slot":"button",className:u(Y({variant:a,size:r,className:t})),...i})}var Q=a(6972),$=a(418),ee=a(2725),et=a(7156),ea=a(1556),es=a(7478);let er={async cloneVoice(e,t,a){try{let s=new FileReader,r=new Promise(t=>{s.onloadend=()=>t(s.result),s.readAsDataURL(e)}),l=await r,i=await fetch("/api/clone-voice",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t||"Hello, how are you today?",audioData:l,sessionId:a})});if(i.ok){let e=await i.blob();return{url:URL.createObjectURL(e)}}throw Error("Voice cloning failed")}catch(e){throw console.error("Voice cloning error:",e),Error("Voice cloning failed")}},async analyzeVoice(e,t){try{let a=new FileReader,s=new Promise(t=>{a.onloadend=()=>t(a.result),a.readAsDataURL(e)}),r=await s,l=await fetch("/api/analyze-voice",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t,audioData:r})});if(l.ok)return l.json();throw Error("Voice analysis failed")}catch(e){throw console.error("Voice analysis error:",e),Error("Voice analysis failed")}},playAudio(e){let t=new Audio(e);return t.play(),t}},el=()=>{let[e,t]=(0,r.useState)(!1),a=(0,r.useRef)(null),s=(0,r.useRef)([]),l=(0,r.useRef)(null),i=(0,r.useRef)(null),n=(0,r.useCallback)(async()=>{try{console.log("\uD83C\uDFA4 WAV 녹음 시작...");let e=await navigator.mediaDevices.getUserMedia({audio:{channelCount:1,sampleRate:44100,sampleSize:16}});i.current=e,s.current=[],l.current=new AudioContext({sampleRate:44100});let r=new MediaRecorder(e,{mimeType:"audio/webm;codecs=opus"}),n=[];return r.ondataavailable=e=>{e.data.size>0&&n.push(e.data)},r.onstop=()=>{console.log("⏹️ MediaRecorder 중지됨")},r.start(100),a.current={stop:()=>new Promise(t=>{r.onstop=()=>{console.log("⏹️ WAV 녹음 중지...");let a=new Blob(n,{type:"audio/webm"});console.log("✅ 오디오 파일 생성 완료: ".concat(a.size," bytes")),e.getTracks().forEach(e=>e.stop()),l.current&&l.current.close(),t(a)},r.stop()}),mediaRecorder:r},t(!0),!0}catch(e){return console.error("❌ WAV 녹음 시작 실패:",e),t(!1),!1}},[]),c=(0,r.useCallback)(async()=>{if(!a.current||!e)return console.warn("⚠️ 녹음이 진행 중이 아닙니다"),null;try{let e=await a.current.stop();return t(!1),e}catch(e){return console.error("❌ WAV 녹음 중지 실패:",e),t(!1),null}},[e]);return{isRecording:e,startRecording:n,stopRecording:c,resetRecording:(0,r.useCallback)(()=>{s.current=[],t(!1),i.current&&(i.current.getTracks().forEach(e=>e.stop()),i.current=null),l.current&&(l.current.close(),l.current=null),console.log("\uD83D\uDD04 WAV 레코더 리셋 완료")},[])}},ei={beginner:{conversation:[{id:"so762_001",text:"We call it bear.",level:"beginner",purpose:"conversation",targetAccuracy:.85,targetFluency:.8,source:"speechocean762"},{id:"so762_002",text:"It is a nice day.",level:"beginner",purpose:"conversation",targetAccuracy:.88,targetFluency:.82,source:"speechocean762"},{id:"so762_003",text:"I like to read books.",level:"beginner",purpose:"conversation",targetAccuracy:.8,targetFluency:.75,source:"speechocean762"},{id:"so762_004",text:"She has a red car.",level:"beginner",purpose:"conversation",targetAccuracy:.83,targetFluency:.78,source:"speechocean762"},{id:"so762_005",text:"The cat is sleeping.",level:"beginner",purpose:"conversation",targetAccuracy:.87,targetFluency:.81,source:"speechocean762"},{id:"so762_006",text:"I have a brother and sister.",level:"beginner",purpose:"conversation",targetAccuracy:.82,targetFluency:.77,source:"speechocean762"}],business:[{id:"so762_b001",text:"Good morning everyone.",level:"beginner",purpose:"business",targetAccuracy:.9,targetFluency:.85,source:"speechocean762"},{id:"so762_b002",text:"Thank you for coming.",level:"beginner",purpose:"business",targetAccuracy:.85,targetFluency:.8,source:"speechocean762"},{id:"so762_b003",text:"Let's start the meeting.",level:"beginner",purpose:"business",targetAccuracy:.83,targetFluency:.78,source:"speechocean762"}]},intermediate:{conversation:[{id:"so762_i001",text:"I would like to discuss this matter with you.",level:"intermediate",purpose:"conversation",targetAccuracy:.75,targetFluency:.7,source:"speechocean762"},{id:"so762_i002",text:"The weather has been quite unpredictable lately.",level:"intermediate",purpose:"conversation",targetAccuracy:.72,targetFluency:.68,source:"speechocean762"},{id:"so762_i003",text:"Could you please explain the procedure to me?",level:"intermediate",purpose:"conversation",targetAccuracy:.78,targetFluency:.73,source:"speechocean762"},{id:"so762_i004",text:"I'm planning to visit several countries next summer.",level:"intermediate",purpose:"conversation",targetAccuracy:.74,targetFluency:.69,source:"speechocean762"}],business:[{id:"so762_ib001",text:"I'd like to schedule a meeting for next week.",level:"intermediate",purpose:"business",targetAccuracy:.8,targetFluency:.75,source:"speechocean762"},{id:"so762_ib002",text:"We need to review the quarterly sales report.",level:"intermediate",purpose:"business",targetAccuracy:.76,targetFluency:.71,source:"speechocean762"}]},advanced:{conversation:[{id:"so762_a001",text:"The implementation of this strategy requires careful consideration of multiple factors.",level:"advanced",purpose:"conversation",targetAccuracy:.65,targetFluency:.6,source:"speechocean762"},{id:"so762_a002",text:"Contemporary literature often reflects the complexities of modern society.",level:"advanced",purpose:"conversation",targetAccuracy:.68,targetFluency:.63,source:"speechocean762"}],business:[{id:"so762_ab001",text:"We need to leverage synergistic opportunities to optimize our competitive advantage.",level:"advanced",purpose:"business",targetAccuracy:.7,targetFluency:.65,source:"speechocean762"}]}},en=async()=>{try{return(await navigator.permissions.query({name:"microphone"})).state}catch(e){return"prompt"}},ec=(e,t)=>{let a="business"===t?"business":"conversation",s=[];return ei[e]&&ei[e][a]?s=ei[e][a].slice(0,8):ei.beginner&&ei.beginner.conversation&&(s=ei.beginner.conversation.slice(0,8)),s.map(e=>({text:e.text,pronunciation:e.text.toLowerCase(),difficulty:e.level}))};function eo(e){let{userProfile:t,clonedVoiceData:a,onBack:i,onComplete:c}=e,[o]=(0,r.useState)(()=>{if(null==a?void 0:a.sessionId)return console.log("✅ 튜토리얼에서 전달받은 sessionId 사용:",a.sessionId),a.sessionId;{let e="session_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9));return console.log("⚠️ 새로운 sessionId 생성 (클로닝된 음성 사용 불가):",e),e}}),[d]=(0,r.useState)(ec((null==t?void 0:t.level)||"beginner",(null==t?void 0:t.purpose)||"conversation")),[x,m]=(0,r.useState)(0),[g,u]=(0,r.useState)(!1),[h,y]=(0,r.useState)(null),[b,f]=(0,r.useState)(Array(8).fill(null)),[v,j]=(0,r.useState)(!1),[w,N]=(0,r.useState)(!1),[k,S]=(0,r.useState)(""),[_,A]=(0,r.useState)(null),[I,T]=(0,r.useState)(!1),[C,D]=(0,r.useState)(null),[P,F]=(0,r.useState)(!1),[O,R]=(0,r.useState)(null),{isRecording:E,startRecording:z,stopRecording:L,resetRecording:V}=el();(0,r.useEffect)(()=>{(null==a?void 0:a.audioBlob)&&d.length>0&&W(d[0].text)},[a,d]);let J=async()=>{j(!0);try{let e=await en();if(console.log("Microphone permission status:",e),"denied"===e)return N(!0),S("마이크 권한이 필요합니다. 브라우저 설정에서 마이크 권한을 허용해주세요."),j(!1),!1;return N(!1),S(""),j(!1),!0}catch(e){return console.error("Microphone check failed:",e),N(!1),j(!1),!0}},W=async e=>{if(null==a?void 0:a.audioBlob){T(!0);try{let t=await er.cloneVoice(a.audioBlob,e,o);A(t.url)}catch(e){console.error("Failed to generate cloned audio:",e)}finally{T(!1)}}},B=async()=>{var e;if(g){null==h||h.pause(),u(!1);return}let t=null===(e=d[x])||void 0===e?void 0:e.text;if(t){j(!0);try{let e;e=(null==a?void 0:a.audioBlob)&&_?_:(await er.cloneVoice(new Blob,t)).url;let s=new Audio(e);y(s),s.onplay=()=>u(!0),s.onended=()=>u(!1),s.onerror=e=>{console.error("Audio playback error:",e),u(!1),N(!0),S("오디오 재생에 실패했습니다.")},await s.play()}catch(e){console.error("Audio generation/playback failed:",e),N(!0),S("음성 생성에 실패했습니다.")}finally{j(!1)}}},q=async()=>{await J()&&(await z()||(N(!0),S("녹음을 시작할 수 없습니다. 마이크 연결을 확인해주세요.")))},G=async()=>{let e=await L();if(!e){N(!0),S("녹음 데이터를 가져올 수 없습니다.");return}R(e),D(URL.createObjectURL(e)),j(!0);try{var t;let a=await er.analyzeVoice(e,d[x].text),s=(null===(t=a.word_analysis)||void 0===t?void 0:t.map(e=>({text:e.word.replace(/[.,!?]/g,""),accuracy:e.accuracy,startTime:e.start_time,endTime:e.end_time})))||d[x].text.split(" ").map((e,t)=>({text:e.replace(/[.,!?]/g,""),accuracy:85,startTime:.5*t,endTime:(t+1)*.5})),r=[...b];r[x]=s,f(r),N(!1)}catch(e){console.error("Pronunciation analysis failed:",e),N(!0),S("발음 분석에 실패했습니다.")}finally{j(!1)}},X=()=>{let e=b.filter(e=>null!==e).length;b.filter(e=>null!==e).reduce((e,t)=>e+((null==t?void 0:t.length)||0),0);let t=b.filter(e=>null!==e).reduce((e,t)=>t?e+t.reduce((e,t)=>e+t.accuracy,0)/t.length:e,0);c({sessionId:o,completedSentences:e,totalSentences:d.length,averageAccuracy:Math.round(e>0?t/e:0),practiceTime:300,sentences:d.map((e,t)=>({text:e.text,pronunciation:e.pronunciation,userPronunciation:b[t],completed:null!==b[t]}))})},Z=d[x],Y=b[x],ei=x<d.length-1,eo=b.every(e=>null!==e);return Z?(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-b from-green-50 to-blue-50",children:(0,s.jsxs)("div",{className:"w-full max-w-sm mx-auto px-4 py-6",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,s.jsx)(K,{variant:"ghost",onClick:i,className:"p-2",children:(0,s.jsx)(p.A,{className:"h-5 w-5"})}),(0,s.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,s.jsx)("h1",{className:"text-xl font-bold text-gray-800 dark:text-gray-200",children:"발음 연습"}),(0,s.jsx)(K,{variant:"ghost",onClick:i,className:"p-2",children:(0,s.jsx)($.A,{className:"h-5 w-5"})})]})]}),(0,s.jsxs)("div",{className:"mb-6",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm text-gray-600 dark:text-gray-400 mb-2",children:[(0,s.jsx)("span",{children:"진행률"}),(0,s.jsxs)("span",{children:[x+1," / ",d.length]})]}),(0,s.jsx)(M,{value:(x+1)/d.length*100,className:"h-2"})]}),(0,s.jsxs)("div",{className:"bg-gradient-to-b from-blue-100 via-green-100 to-yellow-100 rounded-lg p-6 mb-6",children:[(0,s.jsx)("div",{className:"text-center mb-6",children:Y?(0,s.jsx)("div",{className:"text-lg font-medium leading-relaxed",children:Z.text.split(" ").map((e,t)=>{let a=e.replace(/[.,!?]/g,""),r=Y.find(e=>e.text===a),l=(null==r?void 0:r.accuracy)||0,i="";return i=l>=90?"bg-green-200":l>=80?"bg-yellow-200":l>=70?"bg-orange-200":"bg-red-200",(0,s.jsx)("span",{className:"inline-block mx-1 px-2 py-1 rounded ".concat(i),children:e},t)})}):(0,s.jsx)("p",{className:"text-lg font-medium text-gray-800 mb-3",children:Z.text})}),(0,s.jsx)("div",{className:"flex justify-center mb-6",children:(0,s.jsx)("div",{className:"flex items-center space-x-1",children:[...Array(8)].map((e,t)=>(0,s.jsx)("div",{className:"w-1 bg-blue-500 rounded-full transition-all duration-300 ".concat(E?"h-8 animate-pulse":"h-4"),style:{animationDelay:"".concat(.1*t,"s")}},t))})}),(0,s.jsx)("div",{className:"flex justify-center space-x-3 mb-4",children:(0,s.jsxs)(K,{onClick:B,disabled:v||I,className:"bg-blue-500 hover:bg-blue-600 text-white",children:[g?(0,s.jsx)(ee.A,{className:"h-4 w-4"}):(0,s.jsx)(H.A,{className:"h-4 w-4"}),I?"생성 중...":g?"일시정지":"듣기"]})}),Y&&(0,s.jsxs)("div",{className:"text-center mb-4",children:[(0,s.jsxs)("div",{className:"inline-flex items-center justify-center w-16 h-16 bg-blue-500 text-white rounded-full text-xl font-bold",children:[Math.round(Y.reduce((e,t)=>e+t.accuracy,0)/Y.length),"%"]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 mt-2",children:"발음 정확도"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"좋아해요!"}),(0,s.jsxs)("p",{className:"text-xs text-gray-400 mt-1",children:["시도 횟수: ",x+1,"/5"]}),(0,s.jsxs)("div",{className:"mt-4 p-3 bg-white bg-opacity-70 rounded-lg",children:[(0,s.jsx)("p",{className:"text-xs text-gray-600 mb-2",children:"발음 정확도 가이드"}),(0,s.jsxs)("div",{className:"flex justify-center space-x-4 text-xs",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-3 h-3 bg-green-200 rounded mr-1"}),(0,s.jsx)("span",{children:"90%+"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-3 h-3 bg-yellow-200 rounded mr-1"}),(0,s.jsx)("span",{children:"80-89%"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-3 h-3 bg-orange-200 rounded mr-1"}),(0,s.jsx)("span",{children:"70-79%"})]}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsx)("div",{className:"w-3 h-3 bg-red-200 rounded mr-1"}),(0,s.jsx)("span",{children:"~69%"})]})]})]})]})]}),(0,s.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,s.jsxs)(l,{onClick:E?G:q,disabled:v,className:"w-full",children:[E?(0,s.jsx)(et.A,{className:"h-4 w-4 mr-2"}):(0,s.jsx)(n.A,{className:"h-4 w-4 mr-2"}),E?"녹음 중지":"발음 녹음"]}),Y&&(0,s.jsxs)(K,{onClick:()=>{let e=[...b];e[x]=null,f(e),N(!1),V(),C&&(URL.revokeObjectURL(C),D(null)),R(null)},variant:"outline",className:"w-full",children:[(0,s.jsx)(ea.A,{className:"h-4 w-4 mr-2"}),"다시 시도"]})]}),w&&(0,s.jsx)(U,{className:"p-4 mb-6 border-red-200 bg-red-50 dark:border-red-800 dark:bg-red-900/20",children:(0,s.jsxs)("div",{className:"flex items-center text-red-600 dark:text-red-400",children:[(0,s.jsx)(Q.A,{className:"h-4 w-4 mr-2 flex-shrink-0"}),(0,s.jsx)("p",{className:"text-sm",children:k})]})}),(0,s.jsxs)("div",{className:"flex justify-between space-x-3 mb-6",children:[(0,s.jsx)(K,{onClick:()=>{if(x>0){let e=x-1;m(e),(null==a?void 0:a.audioBlob)&&d[e]&&W(d[e].text),h&&(h.pause(),u(!1))}},disabled:!(x>0),variant:"outline",className:"flex-1",children:"이전"}),x===d.length-1?(0,s.jsx)(l,{onClick:X,className:"flex-1",children:"연습 완료"}):(0,s.jsxs)(K,{onClick:()=>{if(x<d.length-1){let e=x+1;m(e),(null==a?void 0:a.audioBlob)&&d[e]&&W(d[e].text),h&&(h.pause(),u(!1))}else X()},disabled:!ei,className:"flex-1 bg-blue-500 hover:bg-blue-600 text-white",children:["다음 문장",(0,s.jsx)(es.A,{className:"h-4 w-4 ml-2"})]})]}),eo&&(0,s.jsx)(l,{onClick:X,className:"w-full",children:"연습 완료"}),v&&(0,s.jsx)("div",{className:"flex justify-center mt-4",children:(0,s.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-500"})})]})}):(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 flex items-center justify-center",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)(Q.A,{className:"h-12 w-12 text-red-500 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"문장을 로드할 수 없습니다."}),(0,s.jsxs)(K,{onClick:i,className:"mt-4",children:[(0,s.jsx)(p.A,{className:"h-4 w-4 mr-2"}),"돌아가기"]})]})})}function ed(e){let{className:t="",showLabels:a=!0}=e,r=E();return(0,s.jsxs)("div",{className:"space-y-3 ".concat(t),children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-gray-700 dark:text-gray-300 text-center",children:"발음 정확도 가이드"}),(0,s.jsx)("div",{className:"space-y-2",children:r.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-3 text-xs",children:[(0,s.jsx)("div",{className:"w-4 h-4 rounded-full ".concat(e.color," flex-shrink-0")}),(0,s.jsxs)("div",{className:"flex-1 flex justify-between items-center",children:[(0,s.jsx)("span",{className:"font-medium text-gray-600 dark:text-gray-400 min-w-[60px]",children:e.range}),a&&(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"text-gray-700 dark:text-gray-300 font-medium",children:e.label}),(0,s.jsx)("span",{className:"text-gray-500 dark:text-gray-400",children:e.description})]})]})]},t))})]})}function ex(){let[e,t]=(0,r.useState)(!1),[a,s]=(0,r.useState)(null),[l,i]=(0,r.useState)(null),n=(0,r.useRef)(null),c=(0,r.useRef)([]);return{isRecording:e,audioBlob:a,audioUrl:l,startRecording:async()=>{try{let e=await navigator.mediaDevices.getUserMedia({audio:!0}),a=new MediaRecorder(e);n.current=a,c.current=[],a.ondataavailable=e=>{e.data.size>0&&c.current.push(e.data)},a.start(),t(!0)}catch(e){console.error("Error accessing microphone:",e),alert("마이크 접근 권한이 필요합니다.")}},stopRecording:()=>new Promise(a=>{if(n.current&&e){let e=n.current;e.onstop=()=>{let t=new Blob(c.current,{type:"audio/webm"});s(t),i(URL.createObjectURL(t)),e.stream.getTracks().forEach(e=>e.stop()),a(t)},e.stop(),t(!1)}else a(null)}),resetRecording:()=>{s(null),l&&(URL.revokeObjectURL(l),i(null))}}}let em=(e,t)=>{let a=70,s=25;switch(t){case"beginner":a=75,s=20;break;case"intermediate":a=70,s=25;break;case"advanced":a=65,s=30}let r=e.split(" ").length;return r>8?a-=5:r<4&&(a+=5),Math.max(50,Math.min(100,Math.round(a+(Math.random()-.5)*s)))};function eg(e){let{level:t,purpose:a,clonedVoiceData:i,onComplete:c}=e,[o,d]=(0,r.useState)(0),[x,m]=(0,r.useState)(null),[g,u]=(0,r.useState)([]),[h,p]=(0,r.useState)(!1),[y,b]=(0,r.useState)(!1),[f,v]=(0,r.useState)([]),{isRecording:j,startRecording:w,stopRecording:N}=ex(),k=(()=>{let e={beginner:{conversation:["We call it bear.","It is a nice day.","I like to read books.","She has a red car.","The cat is sleeping."],business:["Good morning everyone.","Please take a seat.","Thank you for coming.","Let's start the meeting.","Have a great day."],exam:["Education is important.","Study hard every day.","Knowledge is power.","Learning never stops.","Books are our friends."]},intermediate:{conversation:["I'm planning to visit my family next weekend.","The restaurant we went to last night was amazing.","I've been learning English for about two years now.","Would you mind if I joined your conversation?","I completely agree with your opinion on this matter."],business:["I'd like to discuss the project timeline with you.","Our quarterly results exceeded expectations significantly.","We need to implement new strategies for better efficiency.","The presentation went smoothly thanks to everyone's effort.","I'm confident that we can achieve our goals together."],exam:["Academic success requires consistent effort and dedication.","The research methodology was thoroughly explained in the paper.","Environmental conservation is becoming increasingly important globally.","Technology has revolutionized the way we communicate.","Critical thinking skills are essential for problem-solving."]},advanced:{conversation:["I find it fascinating how different cultures approach hospitality.","The nuances in his speech patterns suggest he's quite sophisticated.","I'm particularly intrigued by the philosophical implications of that statement.","The conversation meandered through various topics before settling on politics.","His articulate explanation clarified several misconceptions I had."],business:["We need to leverage our competitive advantages strategically.","The market volatility requires us to diversify our portfolio.","Stakeholder engagement is crucial for sustainable growth.","Our organizational restructuring will optimize operational efficiency.","The comprehensive analysis reveals significant opportunities for expansion."],exam:["The intricate relationship between socioeconomic factors and educational outcomes.","Contemporary literature reflects the complexities of modern society.","Empirical evidence substantiates the hypothesis proposed in the study.","The paradigm shift necessitates a fundamental reevaluation of our assumptions.","Interdisciplinary approaches yield more comprehensive solutions to complex problems."]}};return e[t][a]||e.beginner.conversation})(),S=(o+(null!==x?1:0))/k.length*100,_=async()=>{if(y)return;let e=k[o];if(!(null==i?void 0:i.audioBlob)||!(null==i?void 0:i.sessionId)){console.log("❌ 클로닝된 음성 데이터가 없습니다"),alert("먼저 튜토리얼에서 음성을 녹음해주세요.");return}b(!0);try{console.log("\uD83C\uDFAF 클로닝된 음성으로 재생:",e);let t=await er.cloneVoice(i.audioBlob,e,i.sessionId),a=new Audio(t.url);a.onended=()=>{console.log("✅ 클로닝된 음성 재생 완료"),b(!1)},a.onerror=e=>{console.error("❌ 클로닝된 음성 재생 에러:",e),b(!1),alert("음성 재생에 실패했습니다.")},await a.play()}catch(e){console.error("❌ 클로닝된 음성 생성/재생 실패:",e),b(!1),alert("음성 생성에 실패했습니다. 네트워크 연결을 확인해주세요.")}},A=async()=>{if(j){p(!0);try{if(await N()){let e=k[o],a=em(e,t),s=e.split(" ").map(e=>e.replace(/[.,!?]/g,"")).map(e=>({text:e,accuracy:Math.floor(30*Math.random())+70}));m(a),u([...g,a]),v(s)}}catch(e){console.error("Recording analysis failed:",e)}finally{p(!1)}}else w()};return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-cyan-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:(0,s.jsxs)("div",{className:"w-full px-4 py-6 flex flex-col justify-center min-h-screen",children:[(0,s.jsxs)("div",{className:"text-center mb-6",children:[(0,s.jsx)("div",{className:"w-16 h-16 mx-auto bg-gradient-to-r from-blue-600 to-cyan-600 rounded-2xl flex items-center justify-center mb-4 shadow-xl",children:(0,s.jsx)(n.A,{className:"w-8 h-8 text-white"})}),(0,s.jsx)("h2",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent mb-2",children:"레벨 테스트"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["문장 ",o+1," / ",k.length]}),(0,s.jsx)(M,{value:S,className:"w-full max-w-xs mx-auto"})]})]}),(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-100 dark:border-gray-700 mb-6",children:(()=>{let e=k[o];if(!x||0===f.length)return(0,s.jsxs)("p",{className:"text-lg leading-relaxed text-center",children:['"',e,'"']});let t=e.split(" ");return(0,s.jsxs)("p",{className:"text-lg leading-relaxed text-center",children:['"',t.map((e,t)=>{let a=e.replace(/[.,!?]/g,""),r=f.find(e=>e.text===a),l=R((null==r?void 0:r.accuracy)||0);return(0,s.jsx)("span",{className:"inline-block mx-1 px-1 rounded ".concat(l," transition-all duration-300"),children:e},t)}),'"']})})()}),(0,s.jsx)("div",{className:"text-center space-y-4 mb-6",children:(null==i?void 0:i.audioBlob)&&(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:"샘플 녹음으로 클로닝된 당신의 목소리를 들어보세요"}),(0,s.jsx)(l,{onClick:_,disabled:y||j,className:"mt-2",children:y?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ee.A,{className:"w-4 h-4 mr-2"}),"재생 중..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(H.A,{className:"w-4 h-4 mr-2"}),"내 원어민 발음 듣기"]})})]})}),h&&(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-100 dark:border-gray-700 mb-6",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mx-auto mb-4"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"음성을 분석하고 있습니다..."})]})}),(0,s.jsx)("div",{className:"space-y-4 mb-6",children:null!==x&&(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-100 dark:border-gray-700 space-y-4",children:[(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(z,{accuracy:x,className:"text-lg px-4 py-2"})}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 text-center",children:x>=90?"완벽해요!":x>=80?"잘했어요!":x>=70?"좋아요!":x>=60?"연습하면 더 좋아질 거예요!":"다시 한번 해보세요!"}),(0,s.jsx)(ed,{className:"mt-4",showLabels:!1})]})}),(0,s.jsx)("div",{className:"space-y-3",children:null===x?(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-300 text-center",children:"이제 같은 문장을 따라 말해보세요"}),(0,s.jsx)(l,{onClick:A,disabled:h||y,className:"w-full shadow-lg ".concat(j?"bg-red-500 hover:bg-red-600 text-white":"bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white border-0"),size:"lg",children:j?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.A,{className:"w-5 h-5 mr-2"}),"녹음 중지"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.A,{className:"w-5 h-5 mr-2"}),"녹음 시작"]})})]}):(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(l,{onClick:()=>{o<k.length-1?(d(o+1),m(null),v([])):c({averageScore:g.reduce((e,t)=>e+t,0)/g.length,results:g,adjustedLevel:t})},className:"w-full bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white border-0 shadow-lg",size:"lg",children:o===k.length-1?"테스트 완료":"다음 문장"}),(0,s.jsxs)(l,{onClick:()=>{m(null),v([])},variant:"secondary",className:"w-full shadow-lg",children:[(0,s.jsx)(ea.A,{className:"w-4 h-4 mr-2"}),"다시 시도"]})]})}),g.length>0&&(0,s.jsxs)(U,{className:"p-4",children:[(0,s.jsx)("h4",{className:"font-medium mb-3",children:"지금까지의 점수"}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:g.map((e,t)=>(0,s.jsx)(z,{accuracy:e,className:"text-xs"},t))})]})]})})}let eu=(0,Z.F)("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function eh(e){let{className:t,variant:a,asChild:r=!1,...l}=e,i=r?X.DX:"span";return(0,s.jsx)(i,{"data-slot":"badge",className:u(eu({variant:a}),t),...l})}function ep(e){let{onNext:t,onBack:a}=e,[n,c]=(0,r.useState)(""),[o,d]=(0,r.useState)("");return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-cyan-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:(0,s.jsxs)("div",{className:"w-full px-4 py-8 flex flex-col min-h-screen",children:[(0,s.jsxs)("div",{className:"text-center mb-8 flex-shrink-0",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent mb-2",children:"학습 설정"}),(0,s.jsx)("p",{className:"text-lg text-gray-600 dark:text-gray-300 px-2",children:"당신의 레벨과 목적을 선택해주세요"}),(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsx)(i,{isActive:!0,className:"opacity-60"})})]}),(0,s.jsxs)("div",{className:"space-y-4 mb-8 flex-1",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 text-center",children:"현재 영어 레벨"}),(0,s.jsx)("div",{className:"grid gap-4",children:[{id:"beginner",title:"초급",description:"기본적인 단어와 문장을 배우고 싶어요",features:["기본 단어 300개","간단한 일상 표현","발음 기초"]},{id:"intermediate",title:"중급",description:"어느 정도 대화가 가능하지만 더 자연스럽게 말하고 싶어요",features:["복잡한 문장 구조","다양한 표현","연음 연습"]},{id:"advanced",title:"고급",description:"유창하게 말할 수 있지만 완벽한 발음을 원해요",features:["고급 어휘","미묘한 발음 차이","원어민 수준"]}].map(e=>(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-lg border cursor-pointer transition-all ".concat(n===e.id?"border-blue-500 bg-blue-50 dark:bg-blue-900/20":"border-gray-100 dark:border-gray-700 hover:border-blue-300"),onClick:()=>c(e.id),children:(0,s.jsx)("div",{className:"flex items-start justify-between",children:(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-800 dark:text-gray-200",children:e.title}),n===e.id&&(0,s.jsx)(eh,{className:"bg-gradient-to-r from-blue-500 to-cyan-500 text-white",children:"선택됨"})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mb-3",children:e.description}),(0,s.jsx)("div",{className:"flex flex-wrap gap-2",children:e.features.map(e=>(0,s.jsx)(eh,{variant:"secondary",className:"text-xs bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300",children:e},e))})]})})},e.id))})]}),(0,s.jsxs)("div",{className:"space-y-4 mb-8 flex-1",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 text-center",children:"학습 목적"}),(0,s.jsx)("div",{className:"grid gap-4",children:[{id:"conversation",title:"일상 대화",description:"친구들과 자연스럽게 대화하고 싶어요",icon:"\uD83D\uDCAC"},{id:"business",title:"비즈니스",description:"업무에서 전문적으로 소통하고 싶어요",icon:"\uD83D\uDCBC"},{id:"exam",title:"시험 준비",description:"TOEFL, IELTS 등 시험을 준비하고 있어요",icon:"\uD83D\uDCDA"}].map(e=>(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-lg border cursor-pointer transition-all ".concat(o===e.id?"border-cyan-500 bg-cyan-50 dark:bg-cyan-900/20":"border-gray-100 dark:border-gray-700 hover:border-cyan-300"),onClick:()=>d(e.id),children:(0,s.jsxs)("div",{className:"flex items-center gap-4",children:[(0,s.jsx)("span",{className:"text-2xl",children:e.icon}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-800 dark:text-gray-200",children:e.title}),o===e.id&&(0,s.jsx)(eh,{className:"bg-gradient-to-r from-cyan-500 to-blue-500 text-white",children:"선택됨"})]}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:e.description})]})]})},e.id))})]}),(0,s.jsxs)("div",{className:"space-y-4 flex-shrink-0 relative",style:{zIndex:9999},children:[(0,s.jsx)(l,{onClick:()=>{n&&o&&t(n,o)},disabled:!n||!o,className:"w-full",size:"lg",style:{position:"relative",zIndex:9999},children:"테스트 시작하기"}),(0,s.jsx)("div",{className:"flex justify-between gap-4",children:(0,s.jsx)(K,{variant:"outline",onClick:a,className:"flex-1",children:"이전"})})]})]})})}function ey(e){let{results:t,onComplete:a}=e;if(!t)return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-cyan-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:(0,s.jsx)("div",{className:"w-full px-4 py-8 flex flex-col items-center justify-center min-h-screen",children:(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"결과를 불러오는 중..."})})});let{scores:r=t.results||[75,80,85,78,82],averageScore:l=t.averageScore||80,level:i="intermediate",adjustedLevel:n=t.adjustedLevel||"intermediate"}=t,c=e=>({beginner:"초급",intermediate:"중급",advanced:"고급"})[e]||e,o=e=>e>=90?"bg-green-500":e>=80?"bg-green-400":e>=70?"bg-yellow-500":e>=60?"bg-orange-500":"bg-red-500";return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-cyan-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:(0,s.jsxs)("div",{className:"w-full px-4 py-8 flex flex-col items-center min-h-screen",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("div",{className:"w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,s.jsx)(B.A,{className:"w-8 h-8 text-white"})}),(0,s.jsx)("h1",{className:"text-2xl font-bold text-gray-800 dark:text-gray-200 mb-2",children:"테스트 완료!"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-300",children:"분석 결과를 확인해보세요"})]}),(0,s.jsxs)("div",{className:"w-full max-w-sm space-y-6",children:[(0,s.jsxs)(U,{className:"p-6 text-center bg-white dark:bg-gray-800 shadow-lg",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4",children:"전체 평균 점수"}),(0,s.jsxs)("div",{className:"inline-flex items-center justify-center w-20 h-10 rounded-full text-lg font-bold ".concat(l>=90?"bg-green-500 text-white":l>=80?"bg-green-400 text-white":l>=70?"bg-yellow-500 text-white":"bg-orange-500 text-white"," mb-4"),children:[l,"%"]}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-2",children:(0,s.jsx)("div",{className:"bg-gray-800 h-2 rounded-full transition-all duration-500",style:{width:"".concat(l,"%")}})}),(0,s.jsx)("p",{className:"text-sm text-gray-500",children:"우수한 실력입니다!"})]}),(0,s.jsxs)(U,{className:"p-6 bg-white dark:bg-gray-800 shadow-lg",children:[(0,s.jsx)("h3",{className:"text-lg font-semibold text-gray-800 dark:text-gray-200 mb-4",children:"문장별 점수"}),(0,s.jsx)("div",{className:"flex justify-between items-center mb-2",children:r.map((e,t)=>(0,s.jsxs)("div",{className:"flex flex-col items-center",children:[(0,s.jsx)("div",{className:"w-12 h-6 rounded-full flex items-center justify-center text-xs font-bold text-white ".concat(o(e)," mb-1"),children:e}),(0,s.jsx)("span",{className:"text-xs text-gray-500",children:t+1})]},t))})]}),(0,s.jsx)(U,{className:"p-6 bg-white dark:bg-gray-800 shadow-lg",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center flex-shrink-0 mt-1",children:(0,s.jsx)("div",{className:"w-2 h-2 bg-blue-600 rounded-full"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-1",children:"레벨 조정"}),(0,s.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["선택하신 ",c(i)," 레벨이 적절합니다."]}),(0,s.jsx)("div",{className:"mt-2",children:(0,s.jsx)(eh,{variant:"secondary",className:"text-xs",children:c(n)})})]})]})}),(0,s.jsx)(U,{className:"p-6 bg-white dark:bg-gray-800 shadow-lg",children:(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)(q.A,{className:"w-6 h-6 text-blue-600 flex-shrink-0 mt-1"}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-3",children:"맞춤형 학습 계획"}),(0,s.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"일일 목표:"}),(0,s.jsx)("span",{className:"font-medium",children:"15분 연습"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"주간 목표:"}),(0,s.jsx)("span",{className:"font-medium",children:"30개 문장"})]}),(0,s.jsxs)("div",{className:"flex justify-between",children:[(0,s.jsx)("span",{className:"text-gray-600 dark:text-gray-400",children:"예상 향상 시간:"}),(0,s.jsx)("span",{className:"font-medium",children:"2-3주"})]})]})]})]})}),(0,s.jsx)(K,{onClick:a,className:"w-full bg-blue-600 hover:bg-blue-700 text-white py-3 text-lg font-medium",size:"lg",children:"학습 시작하기"})]})]})})}var eb=a(2640);let ef=async()=>{try{return(await navigator.mediaDevices.getUserMedia({audio:!0})).getTracks().forEach(e=>e.stop()),!0}catch(e){return!1}};function ev(e){let{onPermissionGranted:t}=e,[a,i]=(0,r.useState)(!1),[c,o]=(0,r.useState)(!1),d=async()=>{i(!0),await ef()?(o(!0),setTimeout(()=>{t()},1e3)):alert("마이크 권한이 거부되었습니다. 브라우저 설정에서 마이크를 허용해주세요."),i(!1)};return c?(0,s.jsx)("div",{className:"min-h-screen bg-background flex flex-col p-6",children:(0,s.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center max-w-md mx-auto text-center space-y-8",children:[(0,s.jsx)("div",{className:"w-24 h-24 rounded-full bg-app-success flex items-center justify-center",children:(0,s.jsx)("span",{className:"text-white text-3xl",children:"✓"})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-app-success",children:"마이크 권한 허용됨!"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:"AI 음성 복제 기능을 사용할 수 있습니다."})]}),(0,s.jsx)(K,{onClick:t,className:"w-full",size:"lg",children:"바로 시작하기"})]})}):(0,s.jsxs)("div",{className:"min-h-screen bg-background flex flex-col p-6",children:[(0,s.jsxs)("div",{className:"flex-1 flex flex-col items-center justify-center max-w-md mx-auto text-center space-y-8",children:[(0,s.jsx)("div",{className:"w-24 h-24 rounded-full flex items-center justify-center ".concat(a?"gradient-primary animate-pulse":"gradient-primary"),children:(0,s.jsx)(n.A,{className:"w-12 h-12 text-white"})}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold",children:a?"마이크 권한 요청 중...":"마이크 권한이 필요합니다"}),(0,s.jsx)("p",{className:"text-muted-foreground",children:a?"브라우저에서 마이크 권한을 요청하고 있습니다.":"ShadowMe는 당신의 목소리로 네이티브 발음을 학습하는 앱입니다."})]}),!a&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-full p-4 bg-gradient-to-br from-blue-50 to-cyan-50 border border-blue-200 rounded-lg",children:(0,s.jsxs)("div",{className:"text-center space-y-2",children:[(0,s.jsx)("h4",{className:"text-blue-800 font-medium text-sm",children:"\uD83C\uDFAF ShadowMe 핵심 기능"}),(0,s.jsxs)("p",{className:"text-blue-700 text-xs",children:["• 내 목소리로 네이티브 발음 생성",(0,s.jsx)("br",{}),"• 실시간 발음 정확도 피드백",(0,s.jsx)("br",{}),"• AI 복제 음성으로 섀도잉 학습"]})]})}),(0,s.jsxs)("div",{className:"space-y-3 w-full",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-muted rounded-lg",children:[(0,s.jsx)(eb.A,{className:"w-5 h-5 text-app-success"}),(0,s.jsx)("span",{className:"text-sm",children:"녹음 데이터는 사용자 디바이스에 저장됩니다"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3 p-3 bg-muted rounded-lg",children:[(0,s.jsx)(f.A,{className:"w-5 h-5 text-app-success"}),(0,s.jsx)("span",{className:"text-sm",children:"개인정보는 절대 공유되지 않습니다"})]})]})]}),(0,s.jsxs)(l,{onClick:d,size:"lg",disabled:a,className:"w-full min-h-[56px]",children:[(0,s.jsx)(n.A,{className:"w-5 h-5 mr-2"}),a?"권한 요청 중...":"마이크 권한 허용하고 시작"]}),a&&(0,s.jsx)("div",{className:"w-full p-4 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,s.jsx)("p",{className:"text-yellow-700 text-xs text-center",children:'\uD83D\uDCA1 브라우저 팝업에서 "허용"을 선택해주세요'})})]}),c&&(0,s.jsx)("div",{className:"flex justify-center",children:(0,s.jsx)(l,{variant:"secondary",onClick:t,size:"lg",className:"min-h-[56px]",children:"계속"})})]})}var ej=a(1406);function ew(e){let{onComplete:t}=e,{isRecording:a,startRecording:c,stopRecording:o,resetRecording:d}=ex(),[x]=(0,r.useState)(()=>"tutorial_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9))),[m,g]=(0,r.useState)(!1),[u,h]=(0,r.useState)(!1),[p,y]=(0,r.useState)(0),[b,f]=(0,r.useState)(!1),[v,j]=(0,r.useState)(null),[w,N]=(0,r.useState)(null),k=(0,r.useRef)(null),S="Hello, my name is Sarah and I love learning English.",_=async()=>{if(a){g(!0),h(!0);let e=0,t=setInterval(()=>{y(Math.min(e+=20,90))},200);try{console.log("Stopping recording...");let e=await o();if(console.log("Recording stopped, blob:",e),e){N(e);try{console.log("\uD83C\uDFA4 Starting voice cloning process..."),console.log("\uD83D\uDCDD Text to clone:",S),console.log("\uD83C\uDFB5 Audio blob size:",e.size,"bytes"),console.log("\uD83C\uDFB5 Audio blob type:",e.type);let t=await er.cloneVoice(e,S,x);if(console.log("✅ Voice cloning API response:",t),console.log("\uD83D\uDD17 Result URL type:",typeof t.url),console.log("\uD83D\uDD17 Result URL value:",t.url),t.url){console.log("\uD83C\uDFAF Setting cloned audio URL:",t.url),j(t.url);try{let e=new Audio(t.url);e.onloadeddata=()=>{console.log("✅ Audio URL is valid and loadable")},e.onerror=e=>{console.error("❌ Audio URL test failed:",e)}}catch(e){console.error("❌ Could not test audio URL:",e)}}else{console.log("⚠️  No URL in result, creating fallback from original blob");let t=URL.createObjectURL(e);console.log("\uD83D\uDD04 Fallback URL created:",t),j(t)}}catch(a){console.error("❌ Voice cloning API failed:",a),console.error("❌ API error details:",a instanceof Error?a.message:String(a)),console.log("\uD83D\uDCF1 Using fallback: playing original recording");let t=URL.createObjectURL(e);console.log("\uD83D\uDD04 Fallback URL created:",t),j(t)}}else console.error("No audio blob received"),j(null)}catch(e){console.error("Recording failed:",e),j(null)}finally{clearInterval(t),y(100),setTimeout(()=>h(!1),500)}}else await c(),g(!1)},A=async()=>{if(console.log("\uD83D\uDD0A Play button clicked"),console.log("\uD83C\uDFB5 Cloned audio URL:",v),!v){console.log("❌ No audio URL available"),alert("음성이 준비되지 않았습니다. 다시 녹음해주세요.");return}try{if(b){console.log("⏸️ Stopping current playback"),f(!1);return}console.log("\uD83C\uDFAF Starting audio playback"),console.log("\uD83D\uDD17 Audio URL:",v);let e=new Audio(v);f(!0),e.addEventListener("ended",()=>{console.log("⏹️ Audio playback ended"),f(!1)}),e.addEventListener("error",e=>{console.error("❌ Audio error:",e),f(!1),alert("음성 재생 중 오류가 발생했습니다.")}),console.log("\uD83C\uDFB5 Playing audio..."),await e.play(),console.log("✅ Audio started successfully")}catch(t){console.error("❌ Audio play failed:",t),f(!1);let e=t instanceof Error?t.message:String(t);console.error("Error details:",e),t instanceof Error&&"NotAllowedError"===t.name?alert("\uD83D\uDD0A 브라우저에서 자동재생이 차단되었습니다.\n브라우저 설정에서 localhost 자동재생을 허용해주세요."):alert("음성 재생 실패: ".concat(e))}};return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-cyan-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:[(0,s.jsxs)("div",{className:"w-full px-4 py-8 flex flex-col justify-center min-h-screen",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("div",{className:"w-20 h-20 mx-auto bg-gradient-to-r from-blue-600 to-cyan-600 rounded-2xl flex items-center justify-center mb-4 shadow-xl",children:(0,s.jsx)(n.A,{className:"w-8 h-8 text-white"})}),(0,s.jsx)("h1",{className:"text-2xl font-bold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent mb-2",children:"샘플 녹음"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-300 px-2",children:"아래 문장을 자연스럽게 읽어주세요"})]}),(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-100 dark:border-gray-700 mb-6",children:(0,s.jsxs)("p",{className:"text-lg leading-relaxed text-center text-gray-800 dark:text-gray-200",children:['"',S,'"']})}),(0,s.jsx)("div",{className:"flex justify-center mb-6",children:(0,s.jsx)(i,{isActive:a,size:"lg"})}),(0,s.jsxs)("div",{className:"space-y-4 mb-6",children:[a&&(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-lg border border-gray-100 dark:border-gray-700 text-center",children:[(0,s.jsx)("div",{className:"w-3 h-3 bg-red-500 rounded-full mx-auto animate-pulse mb-2"}),(0,s.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"녹음 중..."})]}),u&&(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-lg border border-gray-100 dark:border-gray-700",children:[(0,s.jsx)("p",{className:"text-sm text-center text-gray-600 dark:text-gray-400 mb-3",children:"\uD83C\uDFA4 당신의 목소리를 원어민 발음으로 변환 중..."}),(0,s.jsx)(M,{value:p,className:"w-full mb-2"}),(0,s.jsxs)("p",{className:"text-xs text-center text-gray-500 dark:text-gray-400",children:[p,"% 완료"]})]}),(console.log("Render conditions:",{hasRecorded:m,isProcessing:u,clonedAudioUrl:v}),m&&!u&&(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-100 dark:border-gray-700 text-center space-y-4",children:[(0,s.jsx)("div",{className:"w-16 h-16 mx-auto bg-gradient-to-r from-green-500 to-cyan-500 rounded-full flex items-center justify-center mb-4",children:(0,s.jsx)("span",{className:"text-white text-2xl",children:"✓"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-green-600 dark:text-green-400 font-semibold text-lg",children:"원어민 발음 변환 완료!"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm mt-1",children:"\uD83C\uDFB5 당신의 목소리가 원어민처럼 들립니다"})]}),(0,s.jsx)("div",{className:"space-y-2",children:(0,s.jsx)(l,{variant:"secondary",onClick:A,disabled:!v,className:"w-full min-h-[48px]",children:b?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ee.A,{className:"w-4 h-4 mr-2"}),"일시정지"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(H.A,{className:"w-4 h-4 mr-2"}),"원어민 발음 듣기"]})})})]}))]}),(0,s.jsx)("div",{className:"space-y-3 mb-6",children:!m||u?(0,s.jsx)(l,{onClick:_,disabled:u,className:"w-full min-h-[56px] ".concat(a?"bg-red-500 hover:bg-red-600 text-white":""),size:"lg",children:a?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(ej.A,{className:"w-5 h-5 mr-2"}),"녹음 중지"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.A,{className:"w-5 h-5 mr-2"}),"녹음 시작"]})}):(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsx)(l,{onClick:()=>t(v?{url:v,sampleText:S,audioBlob:w||void 0,sessionId:x}:void 0),className:"w-full min-h-[56px]",size:"lg",children:"다음 단계로"}),(0,s.jsxs)(l,{onClick:()=>{d(),g(!1),h(!1),y(0),j(null),N(null)},variant:"secondary",className:"w-full min-h-[56px]",size:"lg",children:[(0,s.jsx)(ea.A,{className:"w-4 h-4 mr-2"}),"다시 녹음"]})]})}),(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-lg border border-gray-100 dark:border-gray-700 mb-6",children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-2",children:"\uD83D\uDCA1 녹음 팁:"}),(0,s.jsxs)("ul",{className:"text-sm text-gray-600 dark:text-gray-400 space-y-1",children:[(0,s.jsx)("li",{children:"• 조용한 환경에서 녹음해주세요"}),(0,s.jsx)("li",{children:"• 마이크를 입에서 15-20cm 거리에 두세요"}),(0,s.jsx)("li",{children:"• 자연스럽고 편안하게 말해주세요"})]})]}),(0,s.jsx)("div",{className:"text-center",children:(0,s.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400 px-4",children:"음성 데이터는 사용자 기기에만 저장되며 외부로 전송되지 않습니다"})})]}),v&&(0,s.jsx)("audio",{ref:k,src:v,onEnded:()=>f(!1),onPause:()=>f(!1),onPlay:()=>f(!0),preload:"auto"})]})}var eN=a(6261);function ek(e){let{onNext:t}=e;return(0,s.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-cyan-50 dark:from-gray-900 dark:via-gray-800 dark:to-gray-900",children:(0,s.jsxs)("div",{className:"w-full px-4 py-8 flex flex-col justify-center min-h-screen",children:[(0,s.jsxs)("div",{className:"text-center mb-8",children:[(0,s.jsx)("h1",{className:"text-3xl font-bold bg-gradient-to-r from-blue-600 to-cyan-600 bg-clip-text text-transparent mb-2",children:"AI 음성 복제 기술"}),(0,s.jsx)("p",{className:"text-lg text-gray-600 dark:text-gray-300 px-2",children:"당신의 목소리가 원어민이 되는 마법을 경험해보세요"}),(0,s.jsx)("div",{className:"mt-6",children:(0,s.jsx)(i,{isActive:!0,className:"opacity-60"})})]}),(0,s.jsxs)("div",{className:"space-y-4 mb-8",children:[(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-lg border border-gray-100 dark:border-gray-700",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-gray-500 to-gray-600 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,s.jsx)(y.A,{className:"w-5 h-5 text-white"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"font-semibold mb-1 text-gray-800 dark:text-gray-200",children:"1. 당신의 목소리"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"한국어 억양이 있는 영어 발음"})]}),(0,s.jsx)(i,{size:"sm"})]})}),(0,s.jsx)("div",{className:"flex justify-center py-2",children:(0,s.jsx)(eN.A,{className:"w-6 h-6 text-blue-500 animate-bounce"})}),(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-lg border border-gray-100 dark:border-gray-700",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,s.jsx)(c.A,{className:"w-5 h-5 text-white"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"font-semibold mb-1 text-gray-800 dark:text-gray-200",children:"2. AI 음성 변환"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"원어민 발음으로 실시간 변환"})]}),(0,s.jsx)(i,{isActive:!0,size:"sm"})]})}),(0,s.jsx)("div",{className:"flex justify-center py-2",children:(0,s.jsx)(eN.A,{className:"w-6 h-6 text-green-500 animate-bounce"})}),(0,s.jsx)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-4 shadow-lg border border-gray-100 dark:border-gray-700",children:(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-green-500 to-cyan-500 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,s.jsx)(o.A,{className:"w-5 h-5 text-white"})}),(0,s.jsxs)("div",{className:"flex-1",children:[(0,s.jsx)("h3",{className:"font-semibold mb-1 text-gray-800 dark:text-gray-200",children:"3. 완벽한 원어민 발음"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-sm",children:"당신의 목소리로 듣는 원어민 영어"})]}),(0,s.jsxs)(K,{size:"sm",variant:"outline",className:"border-green-500 text-green-600 hover:bg-green-50",children:[(0,s.jsx)(H.A,{className:"w-4 h-4 mr-1"}),"듣기"]})]})})]}),(0,s.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-xl p-6 shadow-lg border border-gray-100 dark:border-gray-700 mb-8",children:[(0,s.jsx)("h4",{className:"font-semibold text-gray-800 dark:text-gray-200 mb-4 text-center",children:"왜 효과적일까요?"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"w-6 h-6 bg-gradient-to-r from-purple-500 to-pink-500 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:(0,s.jsx)(d.A,{className:"w-3 h-3 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-gray-800 dark:text-gray-200 text-sm",children:"친숙함"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-xs",children:"자신의 목소리로 듣기 때문에 집중도가 높아집니다"})]})]}),(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"w-6 h-6 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:(0,s.jsx)(c.A,{className:"w-3 h-3 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-gray-800 dark:text-gray-200 text-sm",children:"정확성"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-xs",children:"원어민 수준의 정확한 발음을 학습할 수 있습니다"})]})]}),(0,s.jsxs)("div",{className:"flex items-start gap-3",children:[(0,s.jsx)("div",{className:"w-6 h-6 bg-gradient-to-r from-green-500 to-cyan-500 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5",children:(0,s.jsx)(o.A,{className:"w-3 h-3 text-white"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"font-medium text-gray-800 dark:text-gray-200 text-sm",children:"동기부여"}),(0,s.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-xs",children:"내 목소리가 원어민이 되는 신기한 경험"})]})]})]})]}),(0,s.jsx)("div",{className:"space-y-4",children:(0,s.jsx)(l,{onClick:t,className:"w-full",size:"lg",children:"학습 설정 하기"})})]})})}function eS(){let[e,t]=(0,r.useState)("welcome"),[a,l]=(0,r.useState)(!1),[,i]=(0,r.useState)(null),[n,c]=(0,r.useState)(null),[o,d]=(0,r.useState)("login"),[m,g]=(0,r.useState)(""),[u,h]=(0,r.useState)(""),[p,y]=(0,r.useState)(null),[b,f]=(0,r.useState)(null),N=(0,v.UU)("https://".concat(j,".supabase.co"),w);(0,r.useEffect)(()=>{N.auth.getSession().then(e=>{let{data:{session:a}}=e;(null==a?void 0:a.user)&&(i(a.user),C.setAccessToken(a.access_token),C.setUserId(a.user.id),k(),_(),t("dashboard"))})},[]);let k=async()=>{try{let{profile:e}=await C.getProfile();c(e)}catch(e){console.error("Failed to load profile:",e)}},S=e=>{if(e){let t={url:e.url,sampleText:e.sampleText};localStorage.setItem("clonedVoiceData",JSON.stringify(t))}else localStorage.removeItem("clonedVoiceData")},_=()=>{try{let e=localStorage.getItem("clonedVoiceData");if(e){let t=JSON.parse(e);f(t),console.log("\uD83D\uDCE6 저장된 클로닝 음성 데이터 로드:",t)}}catch(e){console.error("Failed to load cloned voice data:",e)}},A=(e,a)=>{i(e),C.setAccessToken(a),C.setUserId(e.id),"signup"===o?t("explanation"):(k(),t("dashboard"))},I=async e=>{try{await C.saveSession({type:"level_test",level:e,completed_at:new Date().toISOString()}),await k(),t("dashboard")}catch(e){console.error("Failed to save level test:",e),t("dashboard")}},T=async e=>{try{await C.saveSession({type:"practice",...e,practice_time:300,overall_accuracy:e.averageAccuracy||75}),await k(),t("dashboard")}catch(e){console.error("Failed to save practice session:",e),t("dashboard")}},U=async()=>{await N.auth.signOut(),i(null),c(null),f(null),S(null),C.setAccessToken(null),C.setUserId(null),t("welcome")},P=()=>{l(!a),document.documentElement.classList.toggle("dark")};return(0,s.jsx)("div",{className:"min-h-screen w-full max-w-sm mx-auto ".concat(a?"dark":""),children:(()=>{switch(e){case"welcome":return(0,s.jsx)(x,{onGetStarted:()=>{d("signup"),t("auth")},onLogin:()=>{d("login"),t("auth")}});case"auth":return(0,s.jsx)(D,{mode:o,onBack:()=>t("welcome"),onAuthSuccess:A});case"levelSelection":return(0,s.jsx)(ep,{onNext:(e,a)=>{g(e),h(a),t("tutorial")},onBack:()=>t("permission")});case"levelTest":return(0,s.jsx)(eg,{level:m,purpose:u,clonedVoiceData:b,onComplete:e=>{y(e),t("testResult")}});case"testResult":return(0,s.jsx)(ey,{results:p,onComplete:()=>{I((null==p?void 0:p.adjustedLevel)||m)}});case"dashboard":return(0,s.jsx)(G,{onStartPractice:()=>t("practice"),onSettings:()=>t("settings"),userProfile:n,clonedVoiceData:b});case"practice":return(0,s.jsx)(eo,{userProfile:n,clonedVoiceData:b,onBack:()=>t("dashboard"),onComplete:T});case"permission":return(0,s.jsx)(ev,{onPermissionGranted:()=>t("levelSelection")});case"tutorial":return(0,s.jsx)(ew,{onComplete:e=>{f(e||null),S(e||null),k(),t("levelTest")}});case"explanation":return(0,s.jsx)(ek,{onNext:()=>t("permission")});case"settings":return(0,s.jsx)("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900",children:(0,s.jsxs)("div",{className:"w-full max-w-sm mx-auto px-4 py-6",children:[(0,s.jsx)("h1",{className:"text-xl mb-6 text-gray-800 dark:text-gray-200",children:"설정"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between p-4 bg-white dark:bg-gray-800 rounded-lg shadow-sm",children:[(0,s.jsx)("span",{className:"text-gray-700 dark:text-gray-300",children:"다크 모드"}),(0,s.jsx)("button",{onClick:P,className:"w-12 h-6 rounded-full transition-colors ".concat(a?"bg-blue-500":"bg-gray-300"),children:(0,s.jsx)("div",{className:"w-5 h-5 rounded-full bg-white transition-transform ".concat(a?"translate-x-6":"translate-x-1")})})]}),(0,s.jsx)("button",{onClick:U,className:"w-full p-4 bg-red-500 text-white rounded-lg hover:bg-red-600 transition-colors min-h-[48px]",children:"로그아웃"}),(0,s.jsx)("button",{onClick:()=>t("dashboard"),className:"w-full p-4 bg-blue-500 text-white rounded-lg hover:bg-blue-600 transition-colors min-h-[48px]",children:"돌아가기"})]})]})});default:return null}})()})}}},e=>{var t=t=>e(e.s=t);e.O(0,[629,441,517,358],()=>t(9185)),_N_E=e.O()}]);