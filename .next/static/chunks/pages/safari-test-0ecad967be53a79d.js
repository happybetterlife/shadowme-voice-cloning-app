(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[945],{2984:(e,a,t)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/safari-test",function(){return t(4920)}])},4920:(e,a,t)=>{"use strict";t.r(a),t.d(a,{default:()=>c});var o=t(4848),s=t(6540);function c(){let[e,a]=(0,s.useState)(!1),[t,c]=(0,s.useState)([]),[r,i]=(0,s.useState)(""),d=(0,s.useRef)(null),n=(0,s.useRef)([]),l=e=>{console.log(e),c(a=>[...a,"".concat(new Date().toLocaleTimeString(),": ").concat(e)])},u=async()=>{try{l("\uD83C\uDFA4 Starting Safari recording test...");let e=navigator.userAgent,t=/^((?!chrome|android).)*safari/i.test(e);l("\uD83D\uDCF1 Browser: ".concat(t?"Safari":"Other"," (").concat(e,")"));let o=await navigator.mediaDevices.getUserMedia({audio:!0});l("✅ Microphone access granted");let s=["audio/webm","audio/webm;codecs=opus","audio/mp4","audio/aac","audio/wav","audio/mpeg"].filter(e=>MediaRecorder.isTypeSupported(e));l("\uD83C\uDFB5 Supported formats: ".concat(s.join(", ")||"None"));let c={};t?MediaRecorder.isTypeSupported("audio/mp4")?c={mimeType:"audio/mp4"}:MediaRecorder.isTypeSupported("audio/aac")&&(c={mimeType:"audio/aac"}):MediaRecorder.isTypeSupported("audio/webm;codecs=opus")?c={mimeType:"audio/webm;codecs=opus"}:MediaRecorder.isTypeSupported("audio/webm")&&(c={mimeType:"audio/webm"}),l("\uD83C\uDFAF Using format: ".concat(JSON.stringify(c)));let r=new MediaRecorder(o,c);d.current=r,n.current=[],r.ondataavailable=e=>{e.data.size>0&&(n.current.push(e.data),l("\uD83D\uDCE6 Data chunk received: ".concat(e.data.size," bytes")))},r.onstop=()=>{let e=r.mimeType||"audio/webm",a=new Blob(n.current,{type:e});l("\uD83C\uDFB5 Recording stopped. Blob created: ".concat(a.size," bytes, type: ").concat(a.type));let t=URL.createObjectURL(a);i(t);let s=new FileReader;s.onloadend=()=>{let e=s.result;l("\uD83D\uDCDD Base64 length: ".concat(e.length)),l("\uD83D\uDCDD Base64 header: ".concat(e.substring(0,50),"...")),m(e)},s.readAsDataURL(a),o.getTracks().forEach(e=>e.stop())},r.onerror=e=>{l("❌ Recording error: ".concat(e))},r.start(),a(!0),l("\uD83C\uDF99️ Recording started..."),setTimeout(()=>{"recording"===r.state&&(r.stop(),a(!1))},3e3)}catch(e){l("❌ Error: ".concat(e)),a(!1)}},m=async e=>{try{l("\uD83C\uDF10 Testing API call...");let a=await fetch("/api/clone-voice",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:"Safari test",audioData:e,sessionId:"safari-test"})});if(l("\uD83D\uDCE1 API Response: ".concat(a.status," ").concat(a.statusText)),a.ok)l("✅ API call successful!");else{let e=await a.text();l("❌ API error: ".concat(e))}}catch(e){l("❌ API call failed: ".concat(e))}};return(0,o.jsx)("div",{className:"min-h-screen bg-gray-100 p-8",children:(0,o.jsxs)("div",{className:"max-w-4xl mx-auto",children:[(0,o.jsx)("h1",{className:"text-3xl font-bold mb-8 text-center",children:"\uD83E\uDDEA Safari 음성 녹음 테스트"}),(0,o.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:(0,o.jsx)("button",{onClick:u,disabled:e,className:"w-full py-4 px-6 rounded-lg text-white font-semibold ".concat(e?"bg-red-500 cursor-not-allowed":"bg-blue-500 hover:bg-blue-600"),children:e?"\uD83C\uDF99️ 녹음 중... (3초)":"\uD83C\uDFA4 녹음 테스트 시작"})}),r&&(0,o.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 mb-6",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"녹음된 오디오"}),(0,o.jsx)("audio",{controls:!0,src:r,className:"w-full"})]}),(0,o.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,o.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"실시간 로그"}),(0,o.jsx)("div",{className:"h-96 overflow-y-auto bg-gray-50 p-4 rounded font-mono text-sm",children:t.map((e,a)=>(0,o.jsx)("div",{className:"mb-1",children:e},a))}),(0,o.jsx)("button",{onClick:()=>c([]),className:"mt-4 px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",children:"로그 지우기"})]}),(0,o.jsx)("div",{className:"mt-8 text-center",children:(0,o.jsx)("button",{onClick:()=>window.location.href="/",className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:"메인으로 돌아가기"})})]})})}}},e=>{var a=a=>e(e.s=a);e.O(0,[636,593,792],()=>a(2984)),_N_E=e.O()}]);