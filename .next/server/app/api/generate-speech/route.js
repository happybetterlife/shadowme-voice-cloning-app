(()=>{var e={};e.id=602,e.ids=[602],e.modules={846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},4870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},9294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},3033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},5390:(e,o,t)=>{"use strict";t.r(o),t.d(o,{patchFetch:()=>h,routeModule:()=>u,serverHooks:()=>f,workAsyncStorage:()=>d,workUnitAsyncStorage:()=>g});var s={};t.r(s),t.d(s,{POST:()=>p});var r=t(2706),n=t(8203),i=t(5994),a=t(9187),l=t(340);let c="21m00Tcm4TlvDq8ikWAM";async function p(e){try{console.log("\uD83C\uDFAF Speech generation request received (App Router)...");let{text:o,sessionId:t,useClonedVoice:s=!1}=await e.json();console.log("\uD83D\uDCDD Text:",o),console.log("\uD83C\uDD94 Session ID:",t),console.log("\uD83C\uDFAD Use cloned voice:",s);let r=c;if(s&&t){console.log("\uD83D\uDD0D 캐시된 음성 찾는 중... sessionId:",t),console.log("\uD83D\uDCCA 현재 캐시된 세션들:",(0,l.E1)());let e=(0,l.po)(t);e?(r=e.voiceId,console.log("⚡ 캐시된 클로닝 음성 사용:",r)):(console.log("⚠️ 세션에 캐시된 음성 없음, 기본 음성 사용 (먼저 샘플 녹음 필요)"),console.log("\uD83D\uDD11 요청된 sessionId:",t),console.log("\uD83D\uDDC2️ 캐시에 있는 sessionId들:",(0,l.E1)()))}else console.log("❌ useClonedVoice:",s,", sessionId:",t);let n=await fetch(`https://api.elevenlabs.io/v1/text-to-speech/${r}`,{method:"POST",headers:{"xi-api-key":"sk_a44152702031b3af9f1a87072171fc9993fdbfb477fba26c","Content-Type":"application/json"},body:JSON.stringify({text:o,model_id:r===c?"eleven_monolingual_v1":"eleven_multilingual_v2",voice_settings:{stability:.7,similarity_boost:.8,style:.5,use_speaker_boost:r!==c}})});if(!n.ok){let e=await n.text();throw console.error("❌ TTS generation failed:",e),Error("TTS generation failed")}let i=await n.arrayBuffer();return new a.NextResponse(i,{headers:{"Content-Type":"audio/mpeg","Content-Disposition":'inline; filename="speech.mp3"',"Access-Control-Allow-Origin":"*","Accept-Ranges":"bytes"}})}catch(e){return console.error("\uD83D\uDCA5 Speech generation error:",e),a.NextResponse.json({error:"Speech generation failed"},{status:500})}}let u=new r.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/generate-speech/route",pathname:"/api/generate-speech",filename:"route",bundlePath:"app/api/generate-speech/route"},resolvedPagePath:"/Users/joy/Desktop/figma_local/ShadowME - AI Voice Cloning Language Learning App/shadowme-nextjs/app/api/generate-speech/route.ts",nextConfigOutput:"",userland:s}),{workAsyncStorage:d,workUnitAsyncStorage:g,serverHooks:f}=u;function h(){return(0,i.patchFetch)({workAsyncStorage:d,workUnitAsyncStorage:g})}},6487:()=>{},8335:()=>{},340:(e,o,t)=>{"use strict";t.d(o,{E1:()=>i,ki:()=>r,po:()=>n});let s=new Map;function r(e,o,t){s.set(e,{voiceId:o,createdAt:Date.now(),sampleText:t}),console.log(`💾 Cached voice clone for session ${e}: ${o}`)}function n(e){return s.get(e)}function i(){return Array.from(s.keys())}}};var o=require("../../../webpack-runtime.js");o.C(e);var t=e=>o(o.s=e),s=o.X(0,[989,452],()=>t(5390));module.exports=s})();