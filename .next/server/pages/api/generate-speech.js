"use strict";(()=>{var e={};e.id=53,e.ids=[53],e.modules={5600:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6762:(e,o)=>{Object.defineProperty(o,"M",{enumerable:!0,get:function(){return function e(o,t){return t in o?o[t]:"then"in o&&"function"==typeof o.then?o.then(o=>e(o,t)):"function"==typeof o&&"default"===t?o:void 0}}})},2563:(e,o,t)=>{t.r(o),t.d(o,{config:()=>a,default:()=>l,routeModule:()=>c});var n=t(9947),r=t(2706),s=t(6762),i=t(4594);let l=(0,s.M)(i,"default"),a=(0,s.M)(i,"config"),c=new n.PagesAPIRouteModule({definition:{kind:r.A.PAGES_API,page:"/api/generate-speech",pathname:"/api/generate-speech",bundlePath:"",filename:""},userland:i})},4594:(e,o,t)=>{t.r(o),t.d(o,{cacheVoiceClone:()=>l,config:()=>a,default:()=>i});let n=process.env.ELEVENLABS_API_KEY||"sk_a44152702031b3af9f1a87072171fc9993fdbfb477fba26c",r="21m00Tcm4TlvDq8ikWAM",s=new Map;async function i(e,o){if("POST"!==e.method)return o.status(405).json({error:"Method not allowed"});try{console.log("\uD83C\uDFAF Speech generation request received...");let{text:t,sessionId:i,useClonedVoice:l=!1}=e.body;console.log("\uD83D\uDCDD Text:",t),console.log("\uD83C\uDD94 Session ID:",i),console.log("\uD83C\uDFAD Use cloned voice:",l);let a=r;if(l&&i){console.log("\uD83D\uDD0D 캐시된 음성 찾는 중... sessionId:",i),console.log("\uD83D\uDCCA 현재 캐시된 세션들:",Array.from(s.keys()));let e=s.get(i);e?(a=e.voiceId,console.log("⚡ 캐시된 클로닝 음성 사용:",a)):(console.log("⚠️ 세션에 캐시된 음성 없음, 기본 음성 사용 (먼저 샘플 녹음 필요)"),console.log("\uD83D\uDD11 요청된 sessionId:",i),console.log("\uD83D\uDDC2️ 캐시에 있는 sessionId들:",Array.from(s.keys())))}else console.log("❌ useClonedVoice:",l,", sessionId:",i);let c=await fetch(`https://api.elevenlabs.io/v1/text-to-speech/${a}`,{method:"POST",headers:{"xi-api-key":n,"Content-Type":"application/json"},body:JSON.stringify({text:t,model_id:a===r?"eleven_monolingual_v1":"eleven_multilingual_v2",voice_settings:{stability:.7,similarity_boost:.8,style:.5,use_speaker_boost:a!==r}})});if(!c.ok){let e=await c.text();throw console.error("❌ TTS generation failed:",e),Error("TTS generation failed")}let d=await c.arrayBuffer();return o.setHeader("Content-Type","audio/mpeg"),o.setHeader("Content-Disposition",'inline; filename="speech.mp3"'),o.setHeader("Access-Control-Allow-Origin","*"),o.setHeader("Accept-Ranges","bytes"),o.send(Buffer.from(d))}catch(e){return console.error("\uD83D\uDCA5 Speech generation error:",e),o.status(500).json({error:"Speech generation failed"})}}function l(e,o,t){s.set(e,{voiceId:o,createdAt:Date.now(),sampleText:t}),console.log(`💾 Cached voice clone for session ${e}: ${o}`)}let a={api:{bodyParser:{sizeLimit:"10mb"}}}},2706:(e,o)=>{var t;Object.defineProperty(o,"A",{enumerable:!0,get:function(){return t}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE",e.IMAGE="IMAGE"}(t||(t={}))},9947:(e,o,t)=>{e.exports=t(5600)}};var o=require("../../webpack-api-runtime.js");o.C(e);var t=o(o.s=2563);module.exports=t})();